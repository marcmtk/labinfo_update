<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns="http://www.w3.org/TR/REC-html40" xmlns:m="http://www.w3.org/1998/Math/MathML">
<head>
<style>
.tblRevInfo thead td div {font-weight:bold}
</style>
<link rel="stylesheet" type="text/css" media="screen" href="css/iso.css"><link rel="stylesheet" type="text/css" media="print" href="css/isoprint20251210.css">
	<link rel="stylesheet" type="text/css" href="D4/Resources/css/DSID/iso20251210.css">
	<link rel="stylesheet" type="text/css" href="D4/Resources/Skins/D42019RSyd/RSDV/iso20251210.css">

    <script type="text/javascript">
        function DocHeadShowHide(inp,DokID) {
            var dInf = document.getElementById("docHeadWrapWrap" + DokID);
            if (dInf) {
                var isShowing = (dInf.className.indexOf("dsidDocHeadWrapWrapOpen") > -1);
                dInf.className = dInf.className.replace(/[ ]*dsidDocHeadWrapWrap(Closed|Open)/, " dsidDocHeadWrapWrap" + (isShowing ? "Closed" : "Open"));
				var dExCo=document.getElementById("dsidExCoBox837589").className="dsidExCoBox dsidExCoBox" + (isShowing ? "Closed" : "Opened");
            }
        }
		function dsidOnDocHeadMouseClick(inp,id) {
			doOnDocHeadMouseClick(inp,id);
		}
    </script><meta http-equiv="Content-Type" content="text/html;charset=utf-8"><link rel="stylesheet" type="text/css" href="D4/Resources/Skins/D42019RSyd/css/iso20251210.css">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes"><?import namespace="v" implementation="#default#VML" ?>
	<meta name="d4-haandbogid" content="218"><meta name="d4-haandbogkort" content="LABInfo KMA, SVS"><meta name="d4-haandbognavn" content="Laboratorieinformation KMA, SVS">
	<meta name="d4-afsnitid" content="8967"><meta name="d4-afsnitnavn" content="Analyser"><meta name="d4-dokumentid" content="837589">
	<meta name="d4-niveauid" content="3"><meta name="d4-niveauini" content="I."><meta name="d4-niveaunavn" content="Instruks">
	<meta name="d4-ejerniveauid" content=""><meta name="d4-ejerniveauini" content=""><meta name="d4-ejerniveaunavn" content="">
	<meta name="d4-doknralpha" content="0">
	<meta name="d4-dokumentnr" content="I.1"><meta name="d4-afsnitnr" content="1"><meta name="d4-doknrextern" content=""><meta name="d4-version" content="2.3"><meta name="d4-version-revision" content=""><meta name="d4-version-revstate" content="">
	<meta name="d4-godkendtaf" content="fyp2ef"><meta name="d4-godkendtdato" content="2024-05-21"><meta name="d4-udgivetdato" content="2024-05-21 13:10:04"><meta name="d4-publiceretdato" content="2024-05-21 13:10:05"><meta name="d4-udloebdato" content="2027-05-21">
	<meta name="d4-dokumentnavn" content="Bakterielt luftvejspanel DNA">
	<title>LABInfo KMA, SVS - I.1 - Bakterielt luftvejspanel DNA, ver. 2.3</title>
<meta name="SesUserID" content="143153">
<meta name="UserID" content="143153">
<script type="text/javascript" language="javascript">
var webProtocol="https";
var webServer="infonet.regionsyddanmark.dk";
var D4DocUsePrintZoom=false;
var D4DocCreateCopyLinks=false;
var D4DocChangeFileSmbLinks=3;
var D4DocEditUseWindow=false;
var D4DocShowEdit=false;
var D4DocShowEditRequested=false;
var FreeFlowDocument=false;
var LeftSpacingWidth=44;
var SupportLandscapePrinting=false;
var PrintFactoryInstalled=false;
var PrintFactoryFree=false;
var D4DocShowBookCrumb=true;
var D4DocShowBookCrumbDoc=false;
var GkInitialer="";
var RequireAcceptorComments=false;
var textAF08="Skriv en besked";
var textAF10="Indtastede kommentarer er ikke gemt.\u005cn\u005cnForlades siden, mistes de indtastede kommentarer";
var DokID=837589;
var BookVer=1;
var UserID=143153;
var bodyWidth="100%";
var sEdit="";
</script>

<script type="text/javascript" language="JavaScript">
var CreateCommentsAll=false;
var PageWidth=640;
var PageHeight=1000;
var PrintPortrait=true;
var DocIsPrinting=false;

var showInfo=(window.D4DocPopup ? new D4DocPopup(true):undefined);

var UseWinSelection=false;
try {
	UseWinSelection=(window.getSelection?true:false);
} catch (e) {
	UseWinSelection=false;
}

// if (document.namespaces) document.namespaces.add('v', 'urn:schemas-microsoft-com:vml', "#default#VML");
var ScriptCount=0;
function dynamicLoadJS(scriptName,scriptName2) {	
	var head = document.getElementsByTagName("head")[0];	
	script = document.createElement('script');	
	script.id = "DynaScript"+ScriptCount;	
	script.type = 'text/javascript';	
	script.src = (scriptName2?scriptName2:scriptName);	
	head.appendChild(script);
	ScriptCount++;
}

function getElementArrayByClass(inpClass,BelowThisItem) {
	if (!BelowThisItem) BelowThisItem=document;
	if (!BelowThisItem) return [];
	if (BelowThisItem.getElementsByClassName) return BelowThisItem.getElementsByClassName(inpClass);
	var allArray=BelowThisItem.getElementsByTagName("*");
	var newArray=new Array();
	inpClass=" "+inpClass+" ";
	for (var i=0;i<allArray.length;i++) {
		if (allArray[i].className && (" "+allArray[i].className+" ").indexOf(inpClass)>-1) {
			newArray.push(allArray[i]);
		}
	}
	return newArray;
}

function CancelEvent(ev,allowBubble) {
	if (!ev) ev=window.event;
	if (ev) {
		ev.returnValue=false;
		if (ev.preventDefault) ev.preventDefault();
		if (!allowBubble) {
			ev.cancelBubble=true;
			if (ev.stopPropagation) ev.stopPropagation();
		}
	}
	return false;
}

var moTODocHead;
function doOnDocHeadMouseOver(inpElement,DokID,evt)
{
	if (moTODocHead) window.clearTimeout(moTODocHead);
	if((inpElement.id=="spSubject" && inpElement.className=="docHeadLabel") || inpElement.id=="spDocHeadInfoPO") {
		if (inpElement.id!="spDocHeadInfoPO") inpElement.style.backgroundColor="ghostwhite";
		hidePopUp(true);
		if (document.getElementById) {
			document.getElementById("docInfo"+DokID).style.display="block";
		} else {
			inpElement.firstChild.nextSibling.style.display="block";
		}
	}
}
function doOnDocHeadMouseOutHide(inpElement,DokID,evt)
{
	inpElement.style.backgroundColor="";
	if (document.getElementById) {
		document.getElementById("docInfo"+DokID).style.display="none";
	} else {
		inpElement.firstChild.style.display="none";
	}
	moTODocHead=false;
}
function doOnDocHeadMouseOut(inpElement,DokID,evt)
{
	if((inpElement.id=="spSubject" && inpElement.className=="docHeadLabel") || inpElement.id=="spDocHeadInfoPO" || inpElement.className.indexOf("InfoBox")>-1) {
		moTODocHead=window.setTimeout(function() {doOnDocHeadMouseOutHide(inpElement,DokID,evt)},500);
	}
}
function doOnDocHeadMouseClick(inpElement,DokID,evt)
{
	if((inpElement.id=="spSubject" && inpElement.className=="docHeadLabel") || inpElement.id=="spDocHeadInfoPO" || inpElement.className.indexOf("InfoBox")>-1) {
		inpElement.style.backgroundColor="";
		var pInf=document.getElementById("docInfo"+DokID);
		if (pInf) pInf.style.display=(pInf.style.display=="none"?"":"none");
	}
	cancelBubble(evt);
}
function ShowHideDocInfoLinks(DokID) {
	if (document.getElementById) {
		if (document.getElementById('docInfoLinks'+DokID).style.display=="none") {
			document.getElementById('docInfoLinks'+DokID).style.display="block";
		} else {
			document.getElementById('docInfoLinks'+DokID).style.display="none";
		}
	}
}

function GetMetaValue(mName) {
	var MetaTags=document.getElementsByTagName("META");
	for (var i in MetaTags) {
		if (MetaTags[i].name==mName) {
			return MetaTags[i].content;
		}
	}
}
function SetSyncDoc(DokID, AfsnitID, BookID, isEditor, showEdit, showTraining, showMeta, showRequest, showGk, hidePrint, showQuiz, hideNewAfs) {
	try {
		if (parent.SetBodyHeader) {
			if (D4DocShowBookCrumb) {
				if (document.getElementById("documentCrumb"+DokID)) {
					parent.SetBodyHeader(document.getElementById("documentCrumb"+DokID).innerHTML +
					(!D4DocShowBookCrumbDoc?
						" &nbsp;-&nbsp; <a href=\"/D4Doc/book/docshow.asp?DokID="+DokID+"\" target=\"fBody\">Bakterielt luftvejspanel DNA</a>"
					:""));
				} else {
					parent.SetBodyHeader(document.title);
				}
			} else {
				parent.SetBodyHeader(document.title);
			}		
			if (parent.showIcons && window.name!="fEdit") {
				parent.showIcons(DokID,BookID,isEditor, showEdit, showTraining, showMeta, showRequest, showGk,hidePrint,true, showQuiz, hideNewAfs, true);
			}
			if (parent.fContentFooter) {
				if (parent.fContentFooter.SetSyncDoc) {
					parent.fContentFooter.SetSyncDoc(DokID,AfsnitID);
				}
			}
		}
	} catch (e) {
	}
}
var DocIsLoaded=false;
var BookID=218;
var DokID=837589;
function docLoaded(newDokID,AfsnitID, newBookID, isEditor, showEdit, showTraining, showMeta, showRequest, showGk, DoPrint,hidePrint, showEditRequested, showQuiz, hideNewAfs) {
	BookID=newBookID;
	DokID=newDokID;
	var DocWordEditor="True";
	D4DocShowEdit=showEdit;
	D4DocShowEditRequested=showEditRequested;
	try { if (parent.SetHasActiveX) parent.SetHasActiveX(false); } catch (e) {}
	
	if (showEdit) {
		try {
			var sT=("ActiveXObject" in window);
			if (sT) {
				var tX=new ActiveXObject("MSXML.DOMDocument");
				document.body.className+=" HasActiveX";
				var tU;
				/* Forslag om test for unsafe activex - dur ikke: viser dialog.
				try {
					tU=new ActiveXObject("WbemScripting.SWbemLocator");
				} catch (e) {}
				*/
				if (parent.SetHasActiveX) parent.SetHasActiveX(true,(tU!=undefined));
			}
		} catch (e) {
			// alert(e.message);
		}
	}
		
	if (document.title!="") {
		try { 
			if (top.SetQSvalue && parent.name!="fBody" && parent.name!="fEditor") { 
				var varSets=[];
				if (showEdit || showEditRequested) {
					varSets.push("sEdit");
					varSets.push("1");
				}
				
				top.SetQSvalue("DokID",""+newDokID,document.title,varSets);
			}
		} catch (e) {}
	}
	SetSyncDoc(newDokID,AfsnitID, newBookID, isEditor, showEdit, showTraining, showMeta, showRequest, showGk, hidePrint, showQuiz, hideNewAfs); 
	if (CreateCommentsAll) {
		CreateCommentsAll();
	}
	DocIsLoaded=true;
	if (DoPrint) {
		if (document && document.queryCommandSupported && document.queryCommandSupported('print')) {
			document.execCommand('print', false, null);
		} else {
			window.print();
		}
		window.close();
	}
	if ((parent==window || parent==null) 
	 || (window.name!="fBody" && window.name!="fEdit" && window.name!="D4DocLinkContents" && window.name.indexOf("StartPage")!=0 && window.location.href.indexOf("docmenu=0")==-1)
	 || (window.location.href.indexOf("docmenu=1")>0)) {
		if (document.getElementById && document.getElementById("divDocTopMenu")) {
			document.getElementById("divDocTopMenu").className="Shown";
		}
		if (document.getElementById && document.getElementById("divDocCrumb") && document.getElementById("divDocCrumb").firstChild) {
			document.getElementById("divDocCrumb").firstChild.className="small";
		}
	}
	window.onscroll=setListeTop;
	if (document.getElementsByClassName && window.d4ImgZoomIn) {
		var cZoom = document.getElementsByClassName("d4ImgZoomMe");
		for (var i=0;i<cZoom.length;i++) {
			if (cZoom[i].className.indexOf("d4ImgZoomMO")>-1) {
				cZoom[i].addEventListener("mouseover",d4ImgZoomIn);
				cZoom[i].addEventListener("mouseout",d4ImgZoomOut);
			} else {
				cZoom[i].addEventListener("click",d4ImgZoomIn);
			}
		}
	}
	var n = (""+navigator.platform);
	var isMac=(n.indexOf("Mac")==0);
	if (D4DocCreateCopyLinks && !(isMac && D4DocChangeFileSmbLinks==3)) {
		if ( ( (D4DocCreateCopyLinks===true || D4DocCreateCopyLinks===1) && !window.clipboardData) || (D4DocCreateCopyLinks===2) ) {
			AddCopyEventToFileLinks();
		}
	} else if (D4DocChangeFileSmbLinks) {
		ChangeFileSmbLinks();
	}
	if (false) {
		var ref=document.querySelectorAll("a.d4RefInt,a.d4AttInt");
		for (var i=0;i<ref.length;i++) {
			ref[i].addEventListener("mouseover",refInternalMouseOver);
			ref[i].addEventListener("mouseout",refInternalMouseOut);
		}
	}
}
var refInternalDiv;
function refInternalClick(ev) {
	if (!ev || !ev.target) return;
	var aTarget=ev.target; 
	while (aTarget.tagName!="A" && aTarget.parentElement) aTarget=aTarget.parentElement;
	if (aTarget.tagName!="A") return;
	var henvisningID=aTarget.getAttribute("henvisningID");
	var daID=aTarget.getAttribute("DokAfsnitID");
	var targetID=aTarget.getAttribute("TargetID");
	if (henvisningID && daID) {
		setEditLocation(ev,"/D4Doc/bookedit/editlinks.asp?DokID=837589&AfsnitID="+daID+"&HenvisID="+henvisningID+"#Form"+henvisningID);
		CancelEvent(ev);
	} else if (targetID) {
		targetID=targetID.replace(/[^0-9]+/g,"");
		setEditLocation(ev,"/D4Doc/bookedit/editforms.asp?FormID="+targetID+"&DokID=837589#formid"+targetID);
		CancelEvent(ev);
	}
	return false;
}
var aHenvisData;
function refInternalMouseOver(ev) {
	if (!ev || !ev.target) return;
	var aTarget=ev.target; 
	while ((aTarget.className=="a4RefIntEdit" || aTarget.tagName!="A") && aTarget.parentElement) aTarget=aTarget.parentElement;
	if (aTarget.tagName!="A") return;
	var cTitle=aTarget.title;
	if (!cTitle) cTitle = aTarget.innerText;
	var D4TargetID = aTarget.getAttribute("D4TargetID");
	var cdata = (aTarget.classList.contains("d4RefInt") ? aHenvisData[D4TargetID] : {TargetID:D4TargetID});
	var targetID=cdata.TargetID;
	var henvisningID=cdata.HenvisningID;
	var daID=cdata.DokAfsnitID;
	var AL=cdata.HasAccessLimit;
	var HT = cdata.HenvisType;
	var linkInfo = aTarget.getAttribute("linkInfo");
	var showDiv = false;
	if (refInternalTO) window.clearTimeout(refInternalTO); refInternalTO = undefined;
	if (!refInternalDiv) {
		refInternalDiv = document.createElement("div");
		refInternalDiv.className = "d4RefIntDiv";
		refInternalDiv.title = "";
		refInternalDiv.addEventListener("click", CancelEvent);
	} else {
		refInternalDiv.style.left="0px";
	}
	if (aTarget.classList.contains("d4RefInt") && henvisningID && daID) {
		showDiv = true;
		if (refInternalDiv.refIntID !== D4TargetID) {
			refInternalDiv.refIntID = D4TargetID;
			aTarget.refIntID = D4TargetID;
			refInternalDiv.innerHTML = "<div>Internt link:<br>" + (HT == 1 ? "Dokument: " : "") + cTitle + "</div>" +
				(AL == "1" ? "<div>Destinationen for dette link er i en h\u00e5ndbog med adgangsbegr\u00e6nsning</div>" : "") + (linkInfo ? "<div>" + linkInfo.replace(/\\n/g, "<br>") + "</div>" : "") +
				(D4DocShowEdit && parent.SetEditLocation ? "<div><a class=\"a4RefIntEdit\" href=\"#Edit\" henvisningID=\"" + henvisningID + "\" DokAfsnitID=\"" + daID + "\" >&raquo; Rediger internt link</a></div>" +
					(HT == 3 ? "<div><a class=\"a4RefIntEdit\" href=\"#Edit\" TargetID=\"" + targetID + "\" >&raquo; Rediger bilag</a></div>" : "") : "");
			if (D4DocShowEdit && HT == 3) {
				var selRef = refInternalDiv.querySelector("div>a[TargetID]");
				if (selRef) selRef.addEventListener("click", refInternalClick);
			}
			if (D4DocShowEdit) {
				var selRef = refInternalDiv.querySelector("div>a[henvisningID]");
				if (selRef) selRef.addEventListener("click", refInternalClick);
			}
		}
    } else if (aTarget.classList.contains("d4AttInt") && targetID) {
		showDiv = true;
		if (refInternalDiv.refIntID !== D4TargetID) {
			refInternalDiv.refIntID = D4TargetID;
			aTarget.refIntID = D4TargetID;
			refInternalDiv.innerHTML = "<div>Bilag:<br>" + cTitle + "</div>" +
				(D4DocShowEdit && parent.SetEditLocation ? "<div><a class=\"a4RefIntEdit\" href=\"#Edit\" TargetID=\"" + targetID + "\" >&raquo; Rediger bilag</a></div>" : "");
			if (D4DocShowEdit) {
				var selRef = refInternalDiv.querySelector("div>a[TargetID]");
				if (selRef) selRef.addEventListener("click", refInternalClick);
			}
		}
    }
	if (showDiv) {
		aTarget.insertBefore(refInternalDiv,null);
		var cra=aTarget.getBoundingClientRect();
		var crd=refInternalDiv.getBoundingClientRect();
		var cCol=document.getElementsByClassName("dsidTextCol")[0];
		if (!cCol) cCol=document.body;
		var crc=cCol.getBoundingClientRect();
		if (crd.left+crd.width>crc.right) {
			var newleft=(crc.right-(crd.left+crd.width));
			if (newleft<-crd.left)  newleft=-crd.left;
			refInternalDiv.style.left=newleft+"px";
		}
		refInternalDiv.style.visibility="visible";
	}
}
var refInternalTO;
function refInternalMouseOutDo(ev) {
	if (refInternalDiv) {
		if (ev && ev.toElement) {
			var aTarget=ev.toElement; 
			while (aTarget.tagName!="A" && aTarget.parentElement) aTarget=aTarget.parentElement;
			if (aTarget.tagName=="A") {
				var refID=aTarget.refIntID;
				if (refID==refInternalDiv.refIntID) {
					CancelEvent(ev);
					return;
				}
			}
		}
		if (refInternalDiv.parentElement) refInternalDiv.parentElement.removeChild(refInternalDiv);
	}
}
function refInternalMouseOut(ev) {
	if (refInternalDiv) {
		if (refInternalTO) window.clearTimeout(refInternalTO);
		refInternalTO = window.setTimeout((function () { var eve = ev; return function () {  refInternalMouseOutDo(eve) } })(ev),250);
	}
}
function removeIcons() {
	try {
		if (parent!=window && parent!=null && window.name!="fEdit") {
			if (parent.removeIcons) {
				parent.removeIcons();
			}
		}
	} catch (e) {}
}
function selectText(container) {
	if (document.selection) {
		var range = document.body.createTextRange();
		range.moveToElementText(container);
		range.select();
	} else if (window.getSelection) {
		var range = document.createRange();
		range.selectNode(container);
		if (window.getSelection().empty) window.getSelection().empty();
		window.getSelection().addRange(range);
	}
}
function CopyTextToClipboard(ev,h,atext) {
	if (!ev) ev=window.event;
	if (window.clipboardData) {
		window.clipboardData.setData('Text',h);
		alert(atext?atext:'Kopieret til udklipsholder.');
	} else {
		var x=document.createElement("span");
		x.innerText=h;
		document.body.insertBefore(x,null);
		selectText(x);
		success = document.execCommand ("copy", false, null);
		document.body.removeChild(x);
		if (success) alert(atext?atext:'Kopieret til udklipsholder.');
	}
	if (ev) {
		CancelEvent(ev);
	}
}
function CopyHrefToClipboard(ev) {
	if (!ev) ev=window.event;
	if (!ev || !ev.target) return;
	var h=ev.target.href;
	if (!h && ev.currentTarget) h=ev.currentTarget.href;
	if (h) {
		var n = (""+navigator.platform);
		var isMac=(n.indexOf("Mac")==0);
		var isWin=(n.indexOf("Win")==0);
		if (D4DocChangeFileSmbLinks==2 || D4DocChangeFileSmbLinks==3) {
			if (isMac && h.indexOf("file:")==0) h=h.replace(/^file/i,"smb");
			if (!isMac && h.indexOf("smb:")==0) h=h.replace(/^smb/i,"file");
		}
		if (isWin) h=decodeURI(h.replace(/\//g,"\\"));
		CopyTextToClipboard(ev,h,'Stien er kopieret til udklipsholder.\r\nInds\u00e6t i adresselinjen i din browser eller i stifinder.');
	}
}
function AddCopyEventToFileLinks() {
	var a=document.querySelectorAll("a[href]");
	if (a.length>0 && a[0].addEventListener) {
		var n = (""+navigator.platform);
		var isMac=(n.indexOf("Mac")==0);
		for (var i=0;i<a.length;i++) {
			var h=a[i].href;
			if (D4DocChangeFileSmbLinks==true) {
				if (isMac && h.indexOf("file:")==0) a[i].href=h.replace(/^file/i,"smb");
				if (!isMac && h.indexOf("smb:")==0) a[i].href=h.replace(/^smb/i,"file");
			}
			if (h.indexOf("file:")==0 || h.indexOf("smb:")==0) {
				a[i].addEventListener("click",CopyHrefToClipboard);
			}
		}
	}
}
function ChangeFileSmbLinks() {
	var a=document.querySelectorAll("a[href]");
	if (a.length>0) {
		for (var i=0;i<a.length;i++) {
			var h=a[i].href;
			var n = (""+navigator.platform);
			var isMac=(n.indexOf("Mac")==0);
			if (isMac && h.indexOf("file:")==0) a[i].href=h.replace(/^file/i,"smb");
			if (!isMac && h.indexOf("smb:")==0) a[i].href=h.replace(/^smb/i,"file");
		}
	}
}

var editWin;
function setEditLocation(evt,inp) {
	if (!evt) evt=window.event;
	if (parent.SetEditLocation) {
		parent.SetEditLocation(evt,inp);
		return;
	}
	if (D4DocEditUseWindow) {
		if (editWin && !editWin.closed && editWin.location) {
			editWin.location.replace(inp);
			return;
		}
		if (!editWin || editWin.closed || !editWin.location) {
			editWin=window.open(inp,"editWin","width=1024,height=800",true);
			return;
		}
	}
	if (parent.fEdit) {
		if (parent.fEdit.contentWindow && parent.fEdit.contentWindow.name=="fEdit") {
			parent.fEdit.contentWindow.location.href=inp;
		} else {
			parent.fEdit.location.href=inp;
		}
	} else if (inp.indexOf("Preview")>0) {
		window.open(inp);
	}
	evt.returnValue=false;
	return false;
}

var dHenvisListe=false;
var dHenvisListeA=false;
function ListeToggle() {
	if (!dHenvisListeA) {
		dHenvisListeA=document.createElement("div");
		dHenvisListeA.style.position="absolute";
		dHenvisListeA.style.top=0;
		dHenvisListeA.style.visibility="hidden"; 
		dHenvisListeA.style.cursor="pointer";
		document.body.appendChild(dHenvisListeA);
	}
	if (!dHenvisListe) {
		if (document.getElementById) {
			dHenvisListe=document.getElementById("HenvisListe");
		} else if (document.all) {
			dHenvisListe=document.all("HenvisListe");
		}
	}
	if (dHenvisListe && dHenvisListeA) {
		dHenvisListeA.innerHTML=dHenvisListe.innerHTML;
//		alert(tabellen.style.pixelWidth);
		if (dHenvisListeA.style.visibility=="hidden") {
			dHenvisListeA.style.left = (parent.document.all("fBody").clientWidth-dHenvisListe.clientWidth-20)+"px";
			dHenvisListeA.style.top=(document.documentElement?document.documentElement:document.body).scrollTop+"px";
			dHenvisListeA.style.visibility="visible";
		} else {
			dHenvisListeA.style.left = "0px";
			dHenvisListeA.style.visibility="hidden";
		}
	}
}

function ListeExists() {
	if (!dHenvisListe) {
		if (document.getElementById) {
			dHenvisListe=document.getElementById("HenvisListe");
		} else if (document.all) {
			dHenvisListe=document.all("HenvisListe");
		}
	}
	return (dHenvisListe!=null);
}

var dAcceptForm=false;
var tAcceptForm=false;
var dAcceptFormMove=false;
var dAccepFormWrap=false;
var dAcceptFormChecked=false;
function setListeTop() {
	if (!dHenvisListe) {
		if (document.getElementById) {
			dHenvisListe=document.getElementById("HenvisListe");
		} else if (document.all) {
			dHenvisListe=document.all("HenvisListe");
		}
	}
	if (!dAcceptForm || !dAcceptFormChecked) {
		if (!dAcceptForm) {
			if (document.getElementById) {
				dAcceptForm=document.getElementById("frmAcceptDok");
			} else if (document.all) {
				dAcceptForm=document.all("frmAcceptDok");
			}
			dAcceptFormMove=dAcceptForm;
		}
		if (!tAcceptForm) {
			if (document.getElementById) {
				tAcceptForm=document.getElementById("divAcceptForm");	
			} else if (document.all) {
				tAcceptForm=document.all("divAcceptForm");
			}
			if (tAcceptForm) dAcceptFormMove=tAcceptForm;
		}
		if (!dAccepFormWrap) {
			if (document.getElementById) {
				dAccepFormWrap=document.getElementById("divAccepFormWrap");	
			} else if (document.all) {
				dAccepFormWrap=document.all("divAccepFormWrap");
			}
			if (!dAccepFormWrap) dAccepFormWrap=dAcceptFormMove;
		}
		if (!tAcceptForm) {
			if (document.getElementById) {
				tAcceptForm=document.getElementById("tblAcceptForm");	
			} else if (document.all) {
				tAcceptForm=document.all("tblAcceptForm");
			}
		}
		if (tAcceptForm && window.DocIsLoaded) {
			var docCover=false;
			docCover=getElementArrayByClass("dsidDocOverWrap");
			if (!docCover || docCover.length==0) {
				docCover=document.body;
			} else {
				docCover=docCover[0];
			}
			var csForm=(tAcceptForm.currentStyle?tAcceptForm.currentStyle:window.getComputedStyle(tAcceptForm,null))
			var bgForm=(csForm.getPropertyValue?csForm.getPropertyValue("background-color"):csForm.backgroundColor);
			var biForm=(csForm.getPropertyValue?csForm.getPropertyValue("background-image"):csForm.backgroundImage);
			if (bgForm=="transparent" && biForm=="none") {
				var bgCol=document.body.style.backgroundColor;
				if (!bgCol || bgCol=="transparent") bgCol="#edeff2";
				var csCover=(docCover.currentStyle?docCover.currentStyle:window.getComputedStyle(docCover,null))
				if (csCover) {
					try {
						if (csCover.getPropertyValue) {
							tAcceptForm.style.backgroundImage=csCover.getPropertyValue("background-image");
							tAcceptForm.style.backgroundRepeat=csCover.getPropertyValue("background-repeat");
							tAcceptForm.style.backgroundPositionY="bottom";
							var nbgCol=csCover.getPropertyValue("background-color");
							if (nbgCol=="transparent") nbgCol=bgCol;
							tAcceptForm.style.backgroundColor=nbgCol;
						} else {
							tAcceptForm.style.backgroundImage=csCover.backgroundImage;
							tAcceptForm.style.backgroundRepeat=csCover.backgroundRepeat;
							tAcceptForm.style.backgroundPositionY="bottom";
							var nbgCol=csCover.backgroundColor;
							if (nbgCol=="transparent") nbgCol=bgCol;
							tAcceptForm.style.backgroundColor=nbgCol;
						}
					} catch (e) {
						if (docCover.currentStyle) {
						}
					}
				}
			}
			dAcceptFormChecked=true;
		}
	}
	if (dHenvisListe && dHenvisListe.style.visibility!="hidden") {
		dHenvisListe.style.top = (document.documentElement?document.documentElement:document.body).scrollTop+"px";
		dHenvisListe.style.left = (parent.document.all("fBody").clientWidth-dHenvisListe.clientWidth-20)+"px";
	}
	if (dAcceptForm && dAcceptFormMove) {
		var formPinned=dAcceptForm.elements["formPinned"];
		if (!formPinned) formPinned=dAcceptForm.formPinned;
		if (formPinned && formPinned.checked) {
			var scrollHeight=(document.documentElement.scrollHeight?document.documentElement.scrollHeight:document.body.scrollHeight);
			var scrollTop=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);
			var clientHeight=(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight);
			var newTop=clientHeight+scrollTop-scrollHeight;
			var acceptTop=getPosition(dAccepFormWrap?dAccepFormWrap:dAcceptFormMove);
			if (dAccepFormWrap!=dAcceptFormMove && newTop<-acceptTop[1]+10) newTop=-acceptTop[1]+10;
			dAcceptFormMove.style.top=newTop+"px";
		} else {
			dAcceptFormMove.style.top="0px";
		}
	}
}

var docTitle=false;
var docTable=false;
var docWMark=false;
var resizeFlows=true;
var resizeFlowsAll=false;
var docSkinned=true;
var docResizeFirst=true;
var docResizeScrollTop=0;
var hasStyleZoom;
function changeFlowZoom(ev,elm) {
	console.log(elm.className);
	var savedZoom=elm.getAttribute("data-savedZoom");
	if (elm.style.zoom!=1 && !savedZoom) {
		savedZoom=elm.style.zoom;
		elm.setAttribute("data-savedZoom",savedZoom);
	}
	if (elm.style.zoom!=1) {
		elm.style.zoom=1;
		elm.parentElement.classList.add("flowZoomed");
	} else {
		elm.style.zoom=savedZoom;
		elm.parentElement.classList.remove("flowZoomed");
	}
}
function applyStyleZoom(e,newZoom) {
	if (hasStyleZoom===undefined) hasStyleZoom=('zoom' in document.createElement('div').style);
	if (hasStyleZoom) {
		e.style.zoom = newZoom;
    } else {
		// by stackoverflow user3654410
		e.style.transform = "none !important"
		e.style.marginRight = "0 !important"
		e.style.marginBottom = "0 !important"
		const width = e.clientWidth
		const height = e.clientHeight
		e.style.transform = "scale("+newZoom+")"
		e.style.transformOrigin = "0 0"
		const pullUp = height - height * newZoom
		const pullLeft = width - width * newZoom
		e.style.marginBottom = "-"+pullUp+"px"
		e.style.marginRight = "-"+pullLeft+"px"
    }
}
function docResize(skipMinWidth) {
	if (!docWMark) {
		if (document.getElementById) {
			docWMark=document.getElementById("divWatermark");
		} else if (document.all) {
			docWMark=document.all("divWatermark");
		}
	}
	if (docWMark) {
		if (document.documentElement) {
			docWMark.style.height=(document.body.scrollHeight>document.documentElement.scrollHeight?document.body.scrollHeight:(document.documentElement.scrollHeight>document.documentElement.offsetHeight?document.documentElement.scrollHeight:document.documentElement.offsetHeight))+"px";
		} else {
			docWMark.style.height=(document.body.scrollHeight>document.body.offsetHeight?document.body.scrollHeight:document.body.offsetHeight)+"px";
		}
	}

	if (!docTitle) {
		if (document.getElementById) {
			docTitle=document.getElementById("tdDocTitle");
		} else if (document.all) {
			docTitle=document.all("tdDocTitle");
		}
	}
	if (docTitle) {
		if (!docTable) {
			if (docTitle.parentNode) {
				docTable=docTitle.parentNode.parentNode;
				if (docTable.tagName!="TABLE") {
					docTable=docTable.parentNode;
				}
			} else {
				docTable=docTitle.parentElement.parentElement;
				if (docTable.tagName!="TABLE") {
					docTable=docTable.parentElement;
				}
			}
		}
		if (docTable && docTable.offsetWidth>204) 
			docTitle.style.width=docTable.offsetWidth-204;
	}
	if (resizeFlows) {
		var docWrap=getElementArrayByClass("dsidDocContWrap")[0]
		if (!docWrap) docWrap=getElementArrayByClass("paperDocContWrap")[0];
		if (!docWrap) docWrap=getElementArrayByClass("tbSysDokInfo")[0];
		if (!docWrap) docWrap=document.body;
		if (docWrap) {
			var cFlows=getElementArrayByClass("d4FlowContainer");
			if (cFlows) {
				for (var i=0;i<cFlows.length;i++) {
					if (resizeFlowsAll || cFlows[i].className.indexOf("d4FlowContainerResizable")>-1) {
						var dFlow=cFlows[i].getElementsByTagName("div")[0];
						var dFlowCS=(dFlow?getComputedStyle(dFlow):null);
						if (dFlowCS) {
							var dFlowWidth=parseInt(dFlowCS.width,10);
							var newFlowZoom = 1;
							var wrapOffsetWidth = docWrap.offsetWidth- (FreeFlowDocument?0:LeftSpacingWidth);
							if (dFlowWidth > wrapOffsetWidth) {
								newFlowZoom = ((wrapOffsetWidth / dFlowWidth) < (30 /100) ? (30/100) : (wrapOffsetWidth / dFlowWidth));
							}
							applyStyleZoom(cFlows[i], newFlowZoom);
							if (newFlowZoom < 1) {
                                let containsFlowZoomer = cFlows[i].parentElement.getElementsByClassName("flowZoomer")?.length > 0;
                                if (!containsFlowZoomer) {
									var dZ = document.createElement("div");
									dZ.className = "flowZoomer";
									cFlows[i].parentElement.insertBefore(dZ, null);
									dZ.addEventListener("click", (function (d) { return function (ev) { var elm = d; changeFlowZoom(ev, elm) } })(cFlows[i]));
								}
							}
						}
					}
				}
			}
		}
	}
	if (docSkinned && !skipMinWidth) {
		var b=getElementArrayByClass('paperPageWrap'); 
		var isDsid=false;
		if (!b || b.length==0) {
			b=getElementArrayByClass('dsidPageWrap');isDsid=true
		}
		var mw=0;
		if (b.length>0) { 
			b[0].style.minWidth='0px';
			var c=getElementArrayByClass('tableDokAfsnit');
			for (var i=0;i<c.length;i++) {
				if (mw<c[i].offsetWidth) mw=c[i].offsetWidth;
			}
			var c=getElementArrayByClass('spD4DocBody');
			for (var i=0;i<c.length;i++) {
				if (mw<c[i].offsetWidth) mw=c[i].offsetWidth;
				var d=c[i].getElementsByTagName('img');
				for (var j=0;j<d.length;j++) {
					if (mw<d[j].offsetWidth) mw=d[j].offsetWidth+60;
				}
				var d=c[i].getElementsByTagName('table');
				for (var j=0;j<d.length;j++) {
					if (mw<d[j].offsetWidth) mw=d[j].offsetWidth+60;
				}
			}
			
			if (!isDsid) {
				c=getElementArrayByClass('tbSysDokHeader');
				for (var i=0;i<c.length;i++) {
					if (mw<c[i].offsetWidth+60) mw=c[i].offsetWidth+60;
				}
			}
			if (mw>0 && b[0].offsetWidth<mw) {
				b[0].style.minWidth=(mw)+'px';
				docResize(true);
			}
			if (docResizeFirst && location.hash) {
				var hElements=document.getElementsByName((""+location.hash).replace(/#/g,""));
				if (!hElements) { // fallback for browsere hvor getElementsByName ikke returnerer elementer med id
					hElements=document.getElementByID((""+location.hash).replace(/#/g,""));
					if (hElements) hElements=[hElements];
				}
				if (hElements && hElements.length>0 && hElements[0].scrollIntoView) hElements[0].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
			}
			if (docResizeScrollTop>0) (document.documentElement?document.documentElement:document.body).scrollTop=docResizeScrollTop;
			docResizeFirst=false;
		}
	}
}


var keepPopUp=0;
var hpu=false;
var CurrentPopUp=false;
var CurrentPopUpSrc=false;
var CurrentPopUpUid=false;
var tdPop=false;
function showPopUp(inp,ev,inpCnt,GetUsers,GetForUsage) {
	if (!ev) ev=window.event;
	if (ev) {
		inp = new String(inp);
		if (inp!="") {
			if (!tdPop) {
				if (document.getElementById) {
					tablePop=document.getElementById("PopUpTable");
					tdPop=document.getElementById("PopUpThingy");
				} else if (document.all) {
					tablePop=document.all.PopUpTable;
					tdPop=document.all.PopUpThingy;
				}
			}
			if (tdPop) {
				tablePop.style.display="block";
				tdPop.innerHTML=inp;
				if (hpu) {
					window.clearTimeout(hpu);
					hpu=false;
				}
				var newX=ev.clientX;
				var newY=ev.clientY;
				if (ev.target && ev.target.getBoundingClientRect) {
					var newPos=ev.target.getBoundingClientRect();
					newX=newPos.left+30;
					newY=newPos.top+(newPos.height<200?newPos.height:200);
				}
				newX+=(document.documentElement.scrollLeft>0?document.documentElement.scrollLeft:document.body.scrollLeft);
				newY+=(!document.body.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);
				if (newX>(document.documentElement.clientWidth>0?document.documentElement.clientWidth:document.body.clientWidth)+(document.documentElement.scrollLeft>0?document.documentElement.scrollLeft:document.body.scrollLeft)-(tablePop.offsetWidth)) {
					newX-=tablePop.offsetWidth+15;
				}
				if (tablePop.offsetParent && tablePop.offsetParent.tagName!="BODY") {
					var eOfs=tablePop.offsetParent;
					while (eOfs.tagName!="BODY" && eOfs.offsetParent) {
						newX-=eOfs.offsetLeft;
						newY-=eOfs.offsetTop;
						eOfs=eOfs.offsetParent;
					}
				}

				if (newX<8) newX=8;
				tablePop.style.left=newX+"px";
				tablePop.style.top=(newY+5)+"px"; // +document.body.scrollTop
				tablePop.style.visibility="visible";
				keepPopUp=1;
				hpu=window.setTimeout("hidePopUp(true)",5000);
				if (GetUsers) {
					CurrentPopUp=tdPop;
					CurrentPopUpSrc=inpCnt;
					CurrentPopUpUid=inpCnt.getAttribute("uid");
					CurrentPopUpIsXml=inpCnt.getAttribute("isxml");
					dynamicLoadJS("getdocusers.asp?ID="+CurrentPopUpUid+(GetForUsage?"&usage="+GetForUsage:"")+(CurrentPopUpIsXml?"&isxml=1":""));
				} else {
					CurrentPopUpUid=false;
				}
			}
		}
	}
}
function showPopUpReposition() {
	var newX=tablePop.offsetLeft;
	if (tablePop) {
		if (tablePop.offsetParent && tablePop.offsetParent.tagName!="BODY") {
			var eOfs=tablePop.offsetParent;
			while (eOfs.tagName!="BODY" && eOfs.offsetParent) {
				newX+=eOfs.offsetLeft;
				eOfs=eOfs.offsetParent;
			}
		}
	}
	if (newX>(document.documentElement.clientWidth>0?document.documentElement.clientWidth:document.body.clientWidth)+(document.documentElement.scrollLeft>0?document.documentElement.scrollLeft:document.body.scrollLeft)-(tablePop.offsetWidth)) {
		newX=(document.documentElement.clientWidth>0?document.documentElement.clientWidth:document.body.clientWidth)+(document.documentElement.scrollLeft>0?document.documentElement.scrollLeft:document.body.scrollLeft)-(tablePop.offsetWidth)-10;
		if (newX<8) newX=8;
		tablePop.style.left=newX+"px";
	}
}
function letsKeepPopUp() {
	keepPopUp=1;
}

function doHidePopUp() {
	if (hpu) {
		window.clearTimeout(hpu);
		hpu=false;
	}
	if (keepPopUp==0) {
		if (document.getElementById) {
			tablePop=document.getElementById("PopUpTable");
		} else if (document.all) {
			tablePop=document.all.PopUpTable;
		}
		if (tablePop) {
			tablePop.style.left="-300px";
			tablePop.style.top="0px";
			tablePop.style.display="none";
			tablePop.style.visibility="hidden";
		}
	}
}
function hidePopUp(hideNow) {
	keepPopUp=0;
	if (hpu) {
		window.clearTimeout(hpu);
		hpu=false;
	}
	if (hideNow) {
		doHidePopUp();
	} else {
		hpu=window.setTimeout("doHidePopUp()",1000);
	}
}


function getPosition(inp) {
	var ofsX=inp.offsetLeft;
	var ofsY=inp.offsetTop;
	while (inp.offsetParent) {
		inp=inp.offsetParent;
		ofsX+=inp.offsetLeft;
		ofsY+=inp.offsetTop;
	}
	return [ofsX,ofsY];
}

function highZ(parent, limit){
	limit = limit || Infinity;
	parent = parent || document.body;
	var who, temp, max= 1, A= [], i= 0;
	var children = parent.childNodes, length = children.length;
	while(i<length){
		who = children[i++];
		if (who.nodeType != 1) continue; // element nodes only
		if (deepCss(who,"position") !== "static") {
			temp = deepCss(who,"z-index");
			if (temp == "auto") { // z-index is auto, so not a new stacking context
				temp = highZ(who);
			} else {
				temp = parseInt(temp, 10) || 0;
			}
		} else { // non-positioned element, so not a new stacking context
			temp = highZ(who);
		}
		if (temp > max && temp <= limit) max = temp;
	}
	return max;
}

function deepCss(who, css) {
	var sty, val, dv= document.defaultView || window;
	if (who.nodeType == 1) {
		sty = css.replace(/\-([a-z])/g, function(a, b){
			return b.toUpperCase();
		});
		val = who.style[sty];
		if (!val) {
			if(who.currentStyle) val= who.currentStyle[sty];
			else if (dv.getComputedStyle) {
				val= dv.getComputedStyle(who,"").getPropertyValue(css);
			}
		}
	}
	return val || "";
}
var d4ImgContainer=false;
function d4ImgZoomIn(inp) {
	if (false && d4ImgContainer) {
		document.body.removeChild(d4ImgContainer);
		msImgContainer=false;
		return;
	}
	if (inp.toElement) inp=inp.toElement;
	if (inp.srcElement) inp=inp.srcElement;
	var OriHeight=parseInt(inp.getAttribute("OriHeight"),10);
	var OriWidth=parseInt(inp.getAttribute("OriWidth"),10);
	if (!isFinite(OriHeight)) {
		OriHeight=inp.naturalHeight;
		OriWidth=inp.naturalWidth;
	}
	if (OriHeight && OriWidth) {
		if (!d4ImgContainer) {
			d4ImgContainer=document.createElement("div");
			if (d4ImgContainer) 
				d4ImgContainer.style.zIndex=highZ()+1;
		}
		if (d4ImgContainer) {
			if (d4ImgContainer.firstChild) d4ImgContainer.removeChild(d4ImgContainer.firstChild);
			if (OriWidth>1280) {
				OriHeight=Math.round((1280/OriWidth)*OriHeight);
				OriWidth=1280;
			}
			if (OriHeight>1024) {
				OriWidth=Math.round((1024/OriHeight)*OriWidth);
				OriHeight=1024;
			}
			d4ImgContainer.className = "d4ImgZoomPopup";
			d4ImgContainer.style.position="absolute";
			document.body.appendChild(d4ImgContainer);
			var dupNode=document.createElement("img");
			dupNode.setAttribute("IsClone","1");
			var newImg=d4ImgContainer.appendChild(dupNode);
			var newPos=getPosition(inp);
			var ofsX=Math.round((OriWidth-inp.offsetWidth)/2);
			var newLeft=newPos[0]-ofsX;
			if (newLeft+OriWidth>document.documentElement.offsetWidth) newLeft=document.documentElement.offsetWidth-OriWidth-20;
			if (newLeft<0) newLeft=0;
			var ofsY=Math.round((OriHeight-inp.offsetHeight)/2);
			var newTop=newPos[1]-ofsY;
			if (newTop<0) newTop=0;
			d4ImgContainer.style.left=newLeft+"px";
			d4ImgContainer.style.top=newTop+"px";
			newImg.src=inp.src;
			newImg.width=OriWidth;
			newImg.height=OriHeight;
			newImg.title=inp.title;
			newImg.onmouseout="d4ImgZoomOut(this)";
			d4ImgContainer.OriVisib = ""+inp.style.visibility;
			d4ImgContainer.OriImage = inp;
			if (newImg.addEventListener) {
				newImg.addEventListener("mouseout",function(event) {if (window.d4ImgZoomOut) d4ImgZoomOut(event)});
				newImg.addEventListener("mouseover",function(event) {if (window.d4ImgZoomOutCancel) d4ImgZoomOutCancel(event)});
				newImg.addEventListener("click",function(event) {if (window.d4ImgZoomNorm) d4ImgZoomNorm(event)});
			} else {
				newImg.attachEvent("onmouseout",function(event) {if (window.d4ImgZoomOut) d4ImgZoomOut()});
				newImg.attachEvent("onmouseover",function(event) {if (window.d4ImgZoomOutCancel) d4ImgZoomOutCancel()});
				newImg.attachEvent("onclick",function(event) {if (window.d4ImgZoomNorm) d4ImgZoomNorm()});
			}
		}
	}
}
function d4ImgZoomNorm(inp) {
	if (!inp) inp=d4ImgContainer;
	if (inp && inp.tagName=="DIV") inp=inp.firstChild;
	if (inp && inp.srcElement) inp=inp.srcElement;
	if (inp && inp.getAttribute && inp.getAttribute("IsClone")=="1") {
		var i = d4ImgContainer.OriImage;
		var v = d4ImgContainer.OriVisib;
		if (i) i.style.visibility = v;
		var p=inp.parentNode;
		document.body.removeChild(p);
		d4ImgContainer=false;
	}
}
var tod4ImgZoomOut=false;
function d4ImgZoomOutCancel(inp) {
	if (tod4ImgZoomOut) window.clearTimeout(tod4ImgZoomOut);
	tod4ZoomOut=false;
}
function d4ImgZoomOut(inp) {
	d4ImgZoomOutCancel(inp);
	tod4ImgZoomOut=window.setTimeout(d4ImgZoomNorm,200);	
}


var CommentCount=0;
var MovingComment=-1;
var MovingOffset=0;
var toSaveAnnComments;

function MoveComment(ev) {
    if (!ev) ev=window.event;
	if (MovingComment>-1) {
		var newOffset=(document.documentElement?ev.clientY + document.documentElement.scrollTop:ev.pageY)-MovingOffset;
		if (newOffset<0) newOffset=0;
		document.getElementById("dComment"+MovingComment).style.top=newOffset+"px";
	}
}

function PickUpComment(ev,CurComment) {
    if (!ev) ev=window.event;
	MovingComment=CurComment;
	MovingOffset=(document.documentElement?event.clientY + document.documentElement.scrollTop:event.pageY)-document.getElementById("dComment"+MovingComment).offsetTop;
}

function DropComment(ev) {
	if (MovingComment && 0==0) OnKeyUpComment(ev,MovingComment);
	MovingComment=-1;
}

function OpenCloseComment(ev,inpImg,CurComment,doOpen) {
	if (!inpImg || !inpImg.src) inpImg=document.getElementById("imgCommentOpenClose"+CurComment);
	if (window.event.shiftKey) {
		if (!doOpen && inpImg.src.indexOf("pilop")>0) {
			for (var i=0;i<CommentCount;i++) {
				CloseSingleComment(ev,undefined,i);
			}
		} else {
			for (var i=0;i<CommentCount;i++) {
				OpenSingleComment(ev,undefined,i);
			}
		}
	} else {
		if (!doOpen && inpImg.src.indexOf("pilop")>0) {
			CloseSingleComment(ev,inpImg,CurComment);
		} else {
			OpenSingleComment(ev,inpImg,CurComment);
		}
	}
}

function OpenSingleComment(ev,inpImg,CurComment) {
	if (!inpImg || !inpImg.src) inpImg=document.getElementById("imgCommentOpenClose"+CurComment);
	if (inpImg) inpImg.src="/D4Doc/images/pilop_medium.gif";
	if (document.getElementById("dComment"+CurComment)) {
		SetCommentHeight(document.getElementById("dCommentWrite"+CurComment));
		document.getElementById("dComment"+CurComment).classList.remove("commentClosed");
		document.getElementById("dCommentWrite"+CurComment).scrollTop=0;
	}
}

function CloseSingleComment(ev,inpImg,CurComment) {
	if (!inpImg || !inpImg.src) inpImg=document.getElementById("imgCommentOpenClose"+CurComment);
	if (inpImg) inpImg.src="/D4Doc/images/pilned_medium.gif";
	if (document.getElementById("dComment"+CurComment)) {
		document.getElementById("dComment"+CurComment).style.height="";
		document.getElementById("dComment"+CurComment).classList.add("commentClosed");
		document.getElementById("dCommentWrite"+CurComment).scrollTop=0;
	}
}

function DeleteComment(ev,inpImg,CurComment) {
	if (!ev) ev=window.event;
	if (ev.ctrlKey) {
		if (confirm("Slet alle kommentarer?")) {
			for (var i=CommentCount;i>-1;i--) {
				if (document.getElementById("dComment"+i)) {
					document.getElementById("dComment"+i).style.display="none";
					if (document.getElementById("dCommentWrite"+i).tagName=="TEXTAREA") {
						document.getElementById("dCommentWrite"+i).value="";
					} else {
						document.getElementById("dCommentWrite"+i).innerHTML="";
					}
				}
			}
		}
	} else if (confirm("Slet denne kommentar?")) {
		document.getElementById("dComment"+CurComment).style.display="none";
		if (document.getElementById("dCommentWrite"+CurComment).tagName=="TEXTAREA") {
			document.getElementById("dCommentWrite"+CurComment).value="";
		} else {
			document.getElementById("dCommentWrite"+CurComment).innerHTML="";
		}
	}
}

function GetDokAfsnitTop(inpID) {
	retVal=0;
	try {
		inpElem=document.getElementById('tableDokAfsnit'+inpID);
		if (inpElem) {
			if (inpElem.offsetTop) {
				retVal=inpElem.offsetTop;
				while (inpElem.offsetParent) {
					inpElem=inpElem.offsetParent;
					retVal+=inpElem.offsetTop;
				}
			}
		} // alert(retVal);
	}
	catch (e) {
		alert(e.description);
	}
	return retVal;
}

function SetCommentHeight(CurSaveWrite) {
	if (!CurSaveWrite) return;
	var newHeight=CurSaveWrite.scrollHeight+CurSaveWrite.parentElement.firstElementChild.offsetHeight+2;
	if (CurSaveWrite.parentElement.offsetHeight<newHeight) {
		CurSaveWrite.parentElement.style.height=(newHeight<130?newHeight+"px":"");
	}
}

function OnKeyUpComment(ev,inp) {
	if (toSaveAnnComments) window.clearTimeout(toSaveAnnComments);
	if (ev && ev.target) {
		var CurSaveWrite = ev.target;
		if (CurSaveWrite.id.indexOf("dCommentWrite") == -1) {
			CurSaveWrite = (inp?document.getElementById("dCommentWrite" + inp):undefined);
		}
		if (CurSaveWrite) {
			var CurSaveTop = GetAnnCommentSavePosition(CurSaveWrite.parentElement);
			var Newtext = (CurSaveWrite.tagName == "TEXTAREA" ? CurSaveWrite.value : CurSaveWrite.innerHTML);
			if ( (CurSaveWrite.savedValue != Newtext) || (CurSaveWrite.savedPosY != CurSaveTop) ) CurSaveWrite.parentElement.classList.remove("annSaved");
			SetCommentHeight(CurSaveWrite);
		}
	}
	toSaveAnnComments=window.setTimeout(DoSaveAnnComments,3000);
}
function GetAnnCommentSavePosition(anComment) {
	var CurSaveTop = anComment.offsetTop;
	if ("" + anComment.DokAfsnitID != "0") {
		var CurSaveAfsnitTop = document.getElementById("tableDokAfsnit" + anComment.DokAfsnitID);
		if (CurSaveAfsnitTop) {
			CurSaveTop = CurSaveTop -  CurSaveAfsnitTop.offsetTop;
		} else {
			anComment.DokAfsnitID = "0";
		}
	}
	return CurSaveTop;
}

function DoSaveAnnComments() {
	if (toSaveAnnComments) window.clearTimeout(toSaveAnnComments);
	var objNotes=[];
	for (var i=0;i<CommentCount;i++) {
		CurSaveComment=document.getElementById("dComment"+i);
		CurSaveHead=document.getElementById("tdCommentHead"+i);
		CurSaveWrite=document.getElementById("dCommentWrite"+i);
		if (CurSaveComment && CurSaveWrite) {
			var CurSaveTop = GetAnnCommentSavePosition(CurSaveComment);
			var Newtext=(CurSaveWrite.tagName=="TEXTAREA"?CurSaveWrite.value:CurSaveWrite.innerHTML);
			if (CurSaveWrite.savedValue!=Newtext || CurSaveWrite.savedPosY!=CurSaveTop) {
				objNotes.push({"AnnID":CurSaveComment.getAttribute("AnID"),"DokID":DokID,"PositionY":CurSaveTop, "GkID":CurSaveComment.getAttribute("GkID"), "DokAfsnitID":CurSaveComment.DokAfsnitID, "Text":Newtext});
				CurSaveWrite.savedValue = Newtext;
				CurSaveWrite.savedPosY = CurSaveTop;
			}
		}
	}
	if (objNotes.length>0) {
		var xml = new XMLHttpRequest();
		xml.onload = self.xmlDone;
		xml.open("POST", "/D4Doc/Included/NoteSet.asp");
		xml.setRequestHeader("Content-Type", "application/x-www-form-urlencoded;charset=utf-8");
		xml.onload = RetSaveAnnComments;
		xml.send("objNotes="+encodeURIComponent(JSON.stringify(objNotes)));
	}
}
function RetSaveAnnComments(ev) {
	if (!ev) return;
	var t = ev.target;
	var r=t.responseText;
    if (r) {
		var rs = r.match(/Saved:\[([^\]]+)\]/i);
		if (rs && rs[1]) {
			var a = rs[1].split(",");
            for (var i = 0; i < a.length; i++) {
				var anID = a[i].split("/");
				var q = document.querySelector("[anid=\"" + anID[0] + "\"]");
                if (q) {
					if (anID.length>1 && anID[0].indexOf("-") == 0) q.setAttribute("anid", anID[1]);
					q.classList.add("annSaved");
                }
            }
		}
		var rs = r.match(/Deleted:\[([^\]]+)\]/i);
		if (rs && rs[1]) {
			var a = rs[1].split(",");
            for (var i = 0; i < a.length; i++) {
				var anID = a[i].split("/");
				var q = document.querySelector("[anid=\"" + anID[0] + "\"]");
				if (q) q.setAttribute("anid", -Math.floor(Math.random() * 9000000)-1);
            }
		}
    }
}

function DateRevString(inp,sep) {
	if (!inp || !inp.getFullYear) return "";
	if (sep===undefined) sep="-";
    try {
		return inp.getFullYear()+sep+(inp.getMonth()<9?"0":"")+(inp.getMonth()+1)+sep+(inp.getDate()<10?"0":"")+inp.getDate();
    } catch (e) {}
	return "";
}

var arrComments=new Array();
var arrCommentTitle = "Privat notat om indholdet";
function CreateCommentSingle(AnnID, DokAfsID, AnGkID, inpHeader, inpText,inpPosition, MakeClosed, MakeReadOnly,Recreate) {
    var CurrentCount=-1;
    var CommentTop=0;
	if (AnnID<0) {
		if (Recreate) {
			NewCommentHead=inpHeader;
			CommentTop=inpPosition;
		} else {
			NewDate=new Date();
			inpText="";
			NewCommentHead=GkInitialer.replace(/</g,"&lt;").replace(/>/g,"&gt;")+" "+DateRevString(NewDate);
			if (document.selection) {
			    CommentTop=document.selection.createRange().offsetTop;
			} else if (UseWinSelection) {
			    var tSelect=window.getSelection();
			    var tRange=(tSelect && tSelect.rangeCount>0 ? tSelect.getRangeAt(0) : undefined);
                if (tRange) {
					var tFrag = tRange.cloneContents();
					if (tFrag.childNodes.length>0)
						CommentTop=tFrag.childNodes[0].offsetTop;

                }
			}
			if (CommentTop<10) {
				CommentTop=(document.documentElement?event.clientY + document.documentElement.scrollTop:event.pageY);
			};
			CommentTop=CommentTop+document.body.scrollTop;
			if (DokAfsID!=0) {
				CommentTop=CommentTop-GetDokAfsnitTop(DokAfsID);
			}
		}
	} else {
		for (var i=0;i<arrComments.length && CurrentCount==-1;i++) {
			if (arrComments[i][0]==AnnID) {
				CurrentCount=i
			}
		}
		NewCommentHead=inpHeader;
		CommentTop=inpPosition;
	}
	if (CommentTop<0) CommentTop=0;
	if (DokAfsID!=0) {
		CommentTop = GetDokAfsnitTop("+DokAfsID+") + CommentTop;
	}
	if (CurrentCount==-1) {
		if (AnnID<0) AnnID = -Math.floor(Math.random() * 9000000)-1;
		var NewDiv=document.createElement("div");
		NewDiv.id="dComment"+CommentCount;
		NewDiv.className="comment";
		NewDiv.setAttribute("AnID",AnnID);
		NewDiv.setAttribute("GkID",AnGkID);
		NewDiv.setAttribute("DokAfsnitID",DokAfsID);
		NewDiv.setAttribute("unselectable","on");
		document.body.insertBefore(NewDiv,document.getElementById("CommentCreateTag"));
		NewDiv.style.right="0px";
		if (MakeReadOnly) {
			NewDiv.style.overflowY="visible";
		} else {
			NewDiv.style.overflowY="hidden";
			if (MakeClosed) {
				NewDiv.classList.add("commentClosed");
			}
		}
		NewDiv.style.top=CommentTop+"px";
		NewDiv.innerHTML =	"<div class='commentHead' id='dCommentHead"+CommentCount+"' unselectable=on onselectstart='return false'>"+
								"<table width='100%' cellspacing=0 cellpadding=0>"+
								"<td id='tdCommentHead"+CommentCount+"' valign=top class='commentHeadIni' unselectable=on onmousedown='PickUpComment(event,"+CommentCount+")' onmouseup='DropComment(event)' onmousemove='MoveComment(event,"+CommentCount+")' onselectstart='return false' nowrap>"+NewCommentHead+"<div class=savedInfo>Gemt</div></td>"+
								"<td class='commentHeadImg' valign=top align=right unselectable=on nowrap>"+
								"<img onclick='DeleteComment(event,this,"+CommentCount+")' style='cursor:default;"+(MakeReadOnly?"display:none;":"")+"' src='/D4Doc/images/delete_medium.gif' width=10 height=13 alt=' Slet ' title='Slet kommentar. Ctrl-klik sletter alle.'>"+
								"<img id='imgCommentOpenClose"+CommentCount+"'onclick='OpenCloseComment(event,this,"+CommentCount+")' style='cursor:default' src='/D4Doc/images/pil"+(MakeReadOnly || !MakeClosed?"op":"ned")+"_medium.gif' width=10 height=13 alt='Luk' title='Luk'>"+
								"</td></table></div>"+
							(false?"<div id='dCommentWrite"+CommentCount+"' class='commentWrite' title='"+arrCommentTitle+"' "+(!MakeReadOnly?(true?" onpaste='CleanComment(event,this)' ":"")+"contenteditable onfocus='OpenCloseComment(event,this,"+CommentCount+",true)' ":"style='"+(MakeClosed?"overflow-y:hidden;":"overflow-y:visible;")+"' unselectable=off")+"></div>"
								:"<textarea id='dCommentWrite"+CommentCount+"' class='commentWrite' onkeyup='OnKeyUpComment(event,this)' title='"+arrCommentTitle+"' "+(!MakeReadOnly?"onfocus='OpenCloseComment(event,this,"+CommentCount+",true)' ":"readonly style='"+(MakeClosed?"overflow-y:hidden;":"overflow-y:visible;")+"' unselectable=off")+"></textarea>")+
							(false?"<div id='dCommentFoot"+CommentCount+"' unselectable=on></div>":"");
		document.getElementById("dComment"+CommentCount).style.display="";
		var dCommWrite=document.getElementById("dCommentWrite"+CommentCount);
		if (dCommWrite) {
			if (dCommWrite.tagName=="TEXTAREA") {
				NewCommentText=(inpText?""+inpText:"");
				dCommWrite.value=NewCommentText;
			} else {
				NewCommentText=(inpText?(""+inpText).replace(/<([\/]?(p|div|b|strong|i|em|span)[^>]*)>/g,"[#$1#]").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\[\#/g,"<").replace(/\#\]/g,">"):"");
				dCommWrite.innerHTML=NewCommentText;
			}
			dCommWrite.savedValue=NewCommentText;
			dCommWrite.savedPosY = CommentTop;
		}
		if (!inpText) {
			if (dCommWrite) dCommWrite.focus();
		} else if (MakeClosed) {
			CloseSingleComment(document.getElementById("imgCommentOpenClose"+CommentCount),CommentCount,true);
		}
		arrComments[CommentCount]=[AnnID,CommentCount,DokAfsID,CommentTop];
//		alert(NewDiv.innerHTML);
		return CommentCount++;
	} else {
		document.getElementById("dComment"+CurrentCount).style.display="";
		document.getElementById("dComment"+CurrentCount).classList.remove("commentClosed");
		document.getElementById("dComment"+CurrentCount).style.top=CommentTop+"px";
		if (Recreate) {
			var dCommWrite=document.getElementById("dCommentWrite"+CurrentCount);
			if (dCommWrite) {
				if (dCommWrite.tagName=="TEXTAREA") {
					NewCommentText=(inpText?""+inpText:"");
					dCommWrite.value=NewCommentText;
				} else {
					NewCommentText=(inpText?(""+inpText).replace(/<([\/]?(p|div|b|strong|i|em|span)[^>]*)>/g,"[#$1#]").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\[\#/g,"<").replace(/\#\]/g,">"):"");
					dCommWrite.innerHTML=NewCommentText;
				}
			}
			dCommWrite.savedValue=NewCommentText;
			dCommWrite.savedPosY = CommentTop;
		}
		return CurrentCount;
	}
}
function CleanComment(ev,inp) {
	ev.preventDefault();
	var text = '';
	if (ev.clipboardData || ev.originalEvent.clipboardData) {
		text = (ev.originalEvent || ev).clipboardData.getData('text/plain');
	} else if (window.clipboardData) {
		text = window.clipboardData.getData('Text');
	}
	if (document.queryCommandSupported('insertText')) {
		document.execCommand('insertText', false, text);
	} else {
		document.execCommand('paste', false, text);
	}
}
function PlaceComments(ev) {
	for (var i=0;i<arrComments.length;i++) {
		var cComment=document.getElementById("dComment"+arrComments[i]);
		if (cComment) {
		}
	}	
}
function HideCommentSingle(ev,AnnID,CurrentCount) {
	if (!CurrentCount && CurrentCount!=0) {
		for (var i=0;i<arrComments.length;i++) {
			if (arrComments[i][0]==AnnID) {
				CurrentCount=i
			}
		}
	}
	if (CurrentCount>=0 && document.getElementById("dComment"+CurrentCount))
		document.getElementById("dComment"+CurrentCount).style.display="none";
}
function ShowCommentCreateTag() {
	var cct=document.getElementById("CommentCreateTag");
	if (!cct) {
		cct=document.createElement("div");
		cct.id="CommentCreateTag";
		cct.className="commentCreate";
		document.body.insertBefore(cct,null);
		cct.title="Opret nyt privat notat";
		cct.innerHTML="&nbsp;+&nbsp;";
		cct.addEventListener("click",CreateComment);
	}
}
function SaveComments(iForm) {
	arrComments=new Array();
	for (var i=0;i<CommentCount;i++) {
		CurSaveComment=document.getElementById("dComment"+i);
		CurSaveHead=document.getElementById("tdCommentHead"+i);
		CurSaveWrite=document.getElementById("dCommentWrite"+i);
		CurSaveTop = GetAnnCommentSavePosition(CurSaveComment);
		if (CurSaveHead && CurSaveWrite) {
			arrComments[arrComments.length]=CurSaveComment.getAttribute("AnID")+"}|{"+CurSaveComment.getAttribute("DokAfsnitID")+"}|{"+(CurSaveWrite.tagName=="TEXTAREA"?CurSaveWrite.value:CurSaveWrite.innerHTML)+"}|{"+CurSaveTop;
		}
	}
	var strComments=arrComments.join("]|[");
	iForm.elements["DokComments"].value=strComments;
	if (RequireAcceptorComments && (AcceptFormClickType!=2)) {
		if (iForm.elements["Kommentarer"]) {
			formComments=""+iForm.elements["Kommentarer"].value;
			formComments=formComments.replace(/\s/g,"");
			if (formComments=="") {
				alert(textAF08);
				iForm.elements["Kommentarer"].focus();
				return false;
			}
		} else {
			return false;
		}
	}
	return true;
}
function ReshowComments() {
	var acCom=document.getElementById("AccComments");
	if (acCom && acCom.value!="") {
		var strComments=acCom.value;
		var arrComR=strComments.split("]|[");
		for (var i=0;i<arrComR.length;i++) {
			var arrCommnt=arrComR[i].split("}|{");
			CreateCommentSingle(arrCommnt[0], arrCommnt[1], 0, "regionsyd\u005csvc-infonet-mb"+" "+DateRevString(new Date()), arrCommnt[2],arrCommnt[3],false,false,true);
		}
	}
}

function CreateComment(ev) {
	doCreateComment=confirm("Opret nyt privat notat");
	if (doCreateComment) {
		CCAfsID=0;
		if (!ev) ev=window.event;
		evElem=ev.srcElement;
		gotElem=false;
		while (evElem.tagName!="BODY" && !gotElem) {
			evElem=evElem.parentElement;
			if (evElem.tagName=="TABLE") {
				if (evElem.rows[0].cells[0].firstChild) {
					if (evElem.rows[0].cells[0].firstChild.tagName=="A" && ""+evElem.rows[0].cells[0].firstChild.name!="undefined") {
						gotElem=evElem.rows[0].cells[0].firstChild;
						CCAfsID=""+gotElem.name;
						if (CCAfsID.indexOf("#dafs")==0) {
							CCAfsID=parseInt(CCAfsID.substr(5),10);
						} else {
							gotElem=false;
						}
					}
				}
			}
		}
		CreateCommentSingle(-1,CCAfsID,0);
	}
}

function MakeEntities(cInp,override) {
	if (!override) return cInp; // disabled (setting D4DocMakeEntities) 
	var newChar="";
	for (var i=cInp.length-1;i>=0;i--) {
		if (cInp.charCodeAt(i)>255 || cInp.charCodeAt(i)==129) {
			if (cInp.charCodeAt(i)==129) {
				cInp=cInp.substr(0,i)+"&#129;"+cInp.substr(i+1);
			} else {
				newChar=escape(cInp.substr(i,1));
				newChar="&#x"+newChar.substr(2)+";";
				cInp=cInp.substr(0,i)+newChar+cInp.substr(i+1);
			}
		}
	}
	return cInp;
}

function checkAccComm(inp) {
	if (parent.AccComm) {
		if (parent.AccComm["GkID"+inp]) {
			var acC=parent.AccComm["GkID"+inp];
			if (acC.length>0) {
				var akField=document.getElementById("AccKommentarer");
				var acField=document.getElementById("AccComments");
				var hasSet=false;
				if (akField && akField.value!=acC[0]) {
					akField.value=acC[0];
					hasSet=true;
				}
				if (acField && acField.value!=acC[1]) {
					acField.value=acC[1];
					ReshowComments();
					hasSet=true;
				}
				if (hasSet) {
					var acImage=document.getElementById("AccCommImg");
					var btnReset=document.getElementById("bReset");
					if (acImage && btnReset) {
						btnReset.style.display="";
						acImage.src="/D4Doc/res/info.gif";
						acImage.title="Kommentarer opdateret fra auto-gem. Brug nulstil for at g\u00e5 tilbage til oprindelig tekst.";
					}
				}
			}
		}
	}
}

var AcceptFormChanged=false;
var AcceptFormClickType=0;
function CheckAcceptForm(evt) {
	if (!evt) {
		evt=window.event;
	}
	if (AcceptFormChanged) {
		evt.returnValue=textAF10;
	} else {
		removeIcons();
	}
}
function SetAcceptFormChanged() {
	AcceptFormChanged=true;
}
function PrepareAcceptForm(iForm) {
	var test=SaveComments(iForm);
	if (test) {
		if (!RequireAcceptorComments && iForm.elements["DokComments"].value=="" && iForm.elements["Kommentarer"].value=="") {
			if (AcceptFormClickType==1 && !iForm.elements["Accepteret"]) {
				test=confirm("Vil du sende et h\u00f8ringssvar uden at skrive kommentarer?");
			}
		}
		if (iForm.elements["Kommentarer"].value!="" || iForm.elements["DokComments"].value=="") {
			if (!parent.AccComm) parent.AccComm=[];
			parent.AccComm["GkID"+iForm.elements["GkID"].value]=[iForm.elements["Kommentarer"].value,iForm.elements["DokComments"].value];
		}
		iForm.elements["Kommentarer"].value=MakeEntities(iForm.elements["Kommentarer"].value);
	}
	AcceptFormChanged=false;
	return test;
}

function AcceptFormClick(inpButton,inpType) {
	// inpType: 1: accept, 2: save / withddraw
	AcceptFormClickType=inpType;
	inpButton.form.elements["WithDrawn"].value=0;
	var hasAccepted=(inpButton.form.elements["Accepteret"] && inpButton.form.elements["Accepteret"].value=='1');
	if (!hasAccepted && inpType == 1 && !inpButton.form.elements["Accepteret"]) hasAccepted=true; // Hearing return answer
	if (inpType == 2 || (inpType == 1 && !hasAccepted) ) { // withdrawal
		
		if (inpButton.form.elements["PrevAccepted"] && inpButton.form.elements["PrevAccepted"].value == "1") {
			if (confirm(inpType==2?"Du har tidligere sendt en godkendelse tilbage. Hvis du gemmer dine kommentarer nu, modsat at sende dem, vil din godkendelse blive trukket tilbage. \u00d8nsker du at g\u00f8re dette?":"Du har tidligere godkendt dette dokument. \u000d\u000a\u00d8nsker du at tr\u00e6kke din godkendelse tilbage?")) {
				inpButton.form.elements["PrevAccepted"].value = 0;
				if (inpType==2) inpButton.form.elements["WithDrawn"].value = 1;
				return true;
			} else {
				return false;
			}
		}
		if (inpButton.form.elements["PreviouslySent"] && inpButton.form.elements["PreviouslySent"].value == "1") {
			if (confirm("Du har tidligere sendt et svar tilbage. Hvis du gemmer dine kommentarer nu, modsat at sende dem, vil dit svar blive trukket tilbage. \u00d8nsker du at g\u00f8re dette?")) {
				inpButton.form.elements["WithDrawn"].value = 1;
				return true;
			} else {
				return false;
			}
		}
	}
	if (inpType==1 && inpButton.form.elements["PrevAccepted"] && hasAccepted) {
		inpButton.form.elements["PrevAccepted"].value=1;
		return true;
	}
}
function CheckRemote() {
	return false;
}

function testPrint() {
	if (document && document.queryCommandSupported && document.queryCommandSupported('print')) {
		document.execCommand('print', false, null);
	} else {
		window.print();
	}
}

function testWPSrv(inp,AsPDF,InclAttach,AsPreview) {
	if (true) { // pdfServer
		if (InclAttach) {
			window.open("/D4PdfSrvClient/?DokID="+DokID+"&Att="+InclAttach+(AsPreview?"&Preview=1":""),"_blank","width=500,height=150");
		} else {
			window.open("/D4PdfSrvClient/?DokID="+DokID+(AsPreview?"&Preview=1":""),"_blank","width=500,height=150");
		}
	} else {
		if (fBodyHeader.getWPSrv) {
			fBodyHeader.getWPSrv(inp,AsPDF,InclAttach)
		} else {
			if (InclAttach) {
				fBodyHeader.document.location.href="/D4WPSrv/getpdf1.aspx?DokID="+DokID+"&UserID="+UserID;
			} else {
				fBodyHeader.document.location.href="/D4WPSrv/getpdf.aspx?DokID="+DokID+"&UserID="+UserID;
			}
		}
	}
}

function testHighlight() {
	curClass=document.body.className;
	if (curClass.indexOf("HideTags")>-1) {
		document.body.className=curClass.replace(/[ ]*HideTags/gi,"");
	} else {
		document.body.className+=" HideTags";
	}
}

var savedBodyHtml=false;
var HasZoomedPrint=false;
var HasPrintCss=false; // false;
var printPageWidth=640;

function SetPagePrint(ev) {
	if (!ev) ev=window.event;
	DocIsPrinting=true;
	if (!HasPrintCss) {
		dynamicLoadJS("/D4Doc/included/printcss.asp?DokID=837589");
		HasPrintCss=true;
	}
	if (PrintFactoryInstalled) {
		if (!PrintFactoryFree) {
			try {
				if (factory && factory.printing) {
					PrintWidth=factory.printing.pageWidth-factory.printing.leftMargin-factory.printing.rightMargin;
					PrintHeight=factory.printing.pageHeight-factory.printing.topMargin-factory.printing.bottomMargin;
					if (factory.printing.GetMarginMeasure()==2) {
						PrintWidth=PrintWidth*25.4;
						PrintHeight=PrintHeight*25.4;
					}
					PageWidth=Math.round(PrintWidth*3.46);
					PageHeight=Math.round(PrintHeight*3.46);
					printPageWidth=PageWidth;
				}
			} catch (e) {}
		}
	}
	if (document.getElementById("docInfo"+DokID)) document.getElementById("docInfo"+DokID).style.display="none";
	if (D4DocUsePrintZoom && !HasZoomedPrint) { // && FreeFlowDocument
		if (false) {
			AllDivs=getElementArrayByClass("div");
			for (i=0;i<AllDivs.length;i++) {
				var cItem=AllDivs[i];
				if ((cItem.id.substr(0,7)=="FlowDiv") && cItem.offsetWidth) {
					if (cItem.offsetWidth>640) {
						TempFlowWidth=cItem.offsetWidth;
						TempFlowHeight=cItem.offsetHeight;
						if (cItem.getAttribute("widthSaved")!="1") {
							cItem.setAttribute("widthOri",cItem.style.width);
							cItem.setAttribute("heightOri",cItem.style.height);
							cItem.setAttribute("widthSaved",1);
						}
						cItem.style.width=printPageWidth+"px";
						cItem.style.height=(printPageWidth/TempFlowWidth*TempFlowHeight)+"px";
						cItem.style.zoom=printPageWidth/TempFlowWidth;
						// alert(cItem.id+": "+cItem.style.zoom);
					}
				}
			}
		}
		AllImages=getElementArrayByClass("d4FlowContainer");
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i];
			if (cItem.offsetWidth>printPageWidth) {
				var oWidth=cItem.offsetWidth;
				var oHeight=cItem.offsetHeight;
				if (cItem.getAttribute("widthSaved")!="1") {
					cItem.setAttribute("widthOri",oWidth);
					cItem.setAttribute("heightOri",oHeight);
					cItem.setAttribute("widthSaved",1);
				} else {
					oWidth=parseInt(cItem.getAttribute("widthOri"),10);
					oHeight=parseInt(cItem.getAttribute("heightOri"),10);
				}
				var flWrap=document.getElementById(cItem.id+"_Wrap");
				cItem.style.zoom=(printPageWidth/oWidth);
				if (flWrap) {
					flWrap.style.overflow="hidden";
					flWrap.style.width=(oWidth*(printPageWidth/oWidth))+"px";
					flWrap.style.height=(oHeight*(printPageWidth/oWidth))+"px";
				}
			}
		}
		AllImages=document.getElementsByTagName("IMG");
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i];
			if (cItem.width && (!cItem.id || (cItem.id.indexOf("FlowImg")!=0 && cItem.id.indexOf("divWatermark")!=0))) {
				if (cItem.offsetWidth>printPageWidth) {
					var oHeight=cItem.offsetHeight;
					var oWidth=cItem.offsetWidth;
					var tRatio=oHeight/oWidth;
					if (cItem.getAttribute("widthSaved")!="1") {
						cItem.setAttribute("widthOri",cItem.offsetWidth);
						cItem.setAttribute("heightOri",cItem.offsetHeight);
						cItem.setAttribute("widthSaved",1);
					}
					cItem.style.width=printPageWidth+"px";
					cItem.style.height=Math.round(printPageWidth*tRatio)+"px";
				}
			}
		}
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i]; // .offsetParent;
			var DontDoThis=false;
			var DoThisDiv=false;
			var cItemParent=cItem.parentNode;
			while(cItemParent && !DontDoThis && !DoThisDiv) {
				var cItemParentID=""+cItemParent.id;
				if (cItemParentID.substr(0,7)=="FlowDiv" || cItemParentID.substr(0,6)=="canvas" || cItemParentID.substr(0,5)=="paper" || cItemParentID.substr(0,4)=="dsid" || cItemParentID.substr(0,12)=="divWatermark") {
					DontDoThis=true;
				} else if (cItemParentID.substr(0,9)=="vmlfixdiv") {
					DoThisDiv=cItemParent;
				}
				cItemParent=cItemParent.parentNode;
			}
			if (DoThisDiv) {
				cItem=DoThisDiv.firstChild;
				if (DoThisDiv.offsetWidth>printPageWidth) {
					var oHeight=DoThisDiv.offsetHeight;
					var oWidth=DoThisDiv.offsetWidth;
					if (cItem.offsetWidth>0 && cItem.offsetWidth<oWidth) oWidth=cItem.offsetWidth;
					var sWidth=oWidth; // parseInt(DoThisDiv.style.pixelWidth,10);
					if (sWidth>0) {
						var tRatio=oHeight/oWidth;
						var nWidth=printPageWidth; // Math.round(sWidth/(oWidth/640));
						if (DoThisDiv.getAttribute("widthSaved")!="1") {
							DoThisDiv.setAttribute("widthOri",DoThisDiv.style.pixelWidth);
							DoThisDiv.setAttribute("heightOri",DoThisDiv.style.pixelHeight);
							DoThisDiv.setAttribute("widthSaved",1);
						}
						DoThisDiv.style.width=""+nWidth+"px";
						DoThisDiv.style.height=Math.round(nWidth*tRatio)+"px";
					} else {
						var tRatio=oHeight/oWidth;
						if (DoThisDiv.getAttribute("widthSaved")!="1") {
							DoThisDiv.setAttribute("widthOri",DoThisDiv.offsetWidth);
							DoThisDiv.setAttribute("heightOri",DoThisDiv.offsetHeight);
							DoThisDiv.setAttribute("widthSaved",1);
						}
						DoThisDiv.style.width=printPageWidth+"px";
						DoThisDiv.style.height=Math.round(printPageWidth*tRatio)+"px";
					}
				}
				if (false && DoThisDiv.offsetWidth>printPageWidth) {
					DoThisDiv.style.zoom=(printPageWidth/DoThisDiv.offsetWidth);
				}
			} else if (cItem.offsetParent) {
				cItem=cItem.offsetParent;
			}
			if (cItem.offsetWidth && (cItem.tagName!="BODY") && !DontDoThis) {
				if (cItem.offsetWidth>printPageWidth) {
					var oHeight=cItem.offsetHeight;
					var oWidth=cItem.offsetWidth;
					var sWidth=parseInt(cItem.style.pixelWidth);
					if (sWidth>0) {
						var tRatio=oHeight/oWidth;
						var nWidth=Math.round(sWidth/(oWidth/printPageWidth));
						if (cItem.getAttribute("widthSaved")!="1") {
							cItem.setAttribute("widthOri",cItem.style.pixelWidth);
							cItem.setAttribute("heightOri",cItem.style.pixelHeight);
							cItem.setAttribute("widthSaved",1);
						}
						cItem.style.width=""+nWidth+"px";
						cItem.style.height=Math.round(nWidth*tRatio)+"px";
					} else {
						var tRatio=oHeight/oWidth;
						if (cItem.getAttribute("widthSaved")!="1") {
							cItem.setAttribute("widthOri",cItem.offsetWidth);
							cItem.setAttribute("heightOri",cItem.offsetHeight);
							cItem.setAttribute("widthSaved",1);
						}
						cItem.style.width=printPageWidth+"px";
						cItem.style.height=Math.round(printPageWidth*tRatio)+"px";
					}
				}
			}

		}
		AllTables=document.getElementsByTagName("table");
		for (i=0;i<AllTables.length;i++) {
			var cItem=AllTables[i];
			if (cItem.offsetWidth && (!cItem.id || (cItem.id.indexOf("flow")!=0)) && ((""+cItem.width).indexOf("%")==-1)) {
				if (cItem.offsetWidth>printPageWidth) {
					if (cItem.getAttribute("widthSaved")!="1") {
						cItem.setAttribute("widthOri",cItem.width);
						cItem.setAttribute("widthSaved",1);
					}
					cItem.style.zoom=(printPageWidth/cItem.offsetWidth);
					// AllTables[i].width=620;
				}
			}
		}
	}
	HasZoomedPrint=true;
	if (PrintFactoryInstalled) {
		if (!PrintFactoryFree) {
			PrintWidth=factory.printing.pageWidth-factory.printing.leftMargin-factory.printing.rightMargin;
			PrintHeight=factory.printing.pageHeight-factory.printing.topMargin-factory.printing.bottomMargin;
			if (factory.printing.GetMarginMeasure()==2) {
				PrintWidth=PrintWidth*25.4;
				PrintHeight=PrintHeight*25.4;
			}
			PageWidth=Math.round(PrintWidth*3.46);
			PageHeight=Math.round(PrintHeight*3.46);

			AllTables=document.getElementsByTagName("TABLE");
			for (i=0;i<AllTables.length;i++) {
				curID=""+AllTables[i].id;
				if (((curID.substr(0,5)=="tbSys") && (curID!="tbSysDokDefEmner")) || curID.substr(0,14)=="tableDokAfsnit") {
					AllTables[i].style.width=PageWidth;
				}
			}
			lastTop=0;
			for (i=0;i<AllTables.length;i++) {
				curID=""+AllTables[i].id;
				if (curID.substr(0,5)!="tbSys" && curID!="HenvisTable" && curID.substr(0,14)!="tableDokAfsnit") {
					for (j=0;j<AllTables[i].rows.length;j++) {
						curRow=AllTables[i].rows[j];
						curElem=curRow;
						curTop=0;
						curTop+=curElem.offsetTop;
						while (curElem.offsetParent) {
							curElem=curElem.offsetParent;
							curTop+=curElem.offsetTop;
						}
						if (curTop+curRow.offsetHeight>lastTop+PageHeight) {
							if (curRow.rowIndex==0) {
								breakElement=curRow.parentElement;
								while (breakElement.tagName!=="TABLE") {
									breakElement=breakElement.parentElement;
								}
							} else {
								breakElement=curRow;
							}
							if (breakElement.style.pageBreakBefore!="always") {
								breakElement.style.pageBreakBefore="always";
								breakElement.setAttribute("AutoBreak","1");
								lastTop=curTop;
		//						alert(curTop+curRow.firstChild.innerHTML);
							} else {
								lastTop=curTop;
							}
						}
					}
				}
			}
		} else {
			if (window.initPrinter) initPrinter(!PrintPortrait);
		}
	}
}

function ResetPagePrint() {
	DocIsPrinting=false;
	if (D4DocUsePrintZoom && HasZoomedPrint) { //  && FreeFlowDocument
		AllDivs=document.getElementsByTagName("DIV");
		for (i=0;i<AllDivs.length;i++) {
			var cItem=AllDivs[i];
			if (cItem.id.substr(0,7)=="FlowDiv") {
				if (cItem.getAttribute("widthSaved")=="1") {
					cItem.style.width=cItem.getAttribute("widthOri")+"px";
					cItem.style.height=cItem.getAttribute("heightOri")+"px";
					cItem.style.zoom="normal";
				}
			}
		}
		AllImages=getElementArrayByClass("d4FlowContainer");
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i];
			if (cItem.getAttribute("widthSaved")=="1") {
				cItem.style.zoom="1";
				cItem.style.removeProperty("zoom");
				var flWrap=document.getElementById(cItem.id+"_Wrap");
				if (flWrap) {
					flWrap.style.overflow="auto";
					flWrap.style.removeProperty("overflow");
					flWrap.style.width=cItem.getAttribute("widthOri")+"px";
					flWrap.style.removeProperty("width");
					flWrap.style.height=cItem.getAttribute("heightOri")+"px";
					flWrap.style.removeProperty("height");
				}
			}
		}
		AllImages=document.getElementsByTagName("IMG");
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i];
			if (cItem.getAttribute("widthSaved")=="1") {
				cItem.style.width=cItem.getAttribute("widthOri");
				cItem.style.height=cItem.getAttribute("heightOri");
			}
		}

		AllImages=document.getElementsByTagName("imagedata");
		for (i=0;i<AllImages.length;i++) {
			var cItem=AllImages[i];
			var DoThisDiv=false;
			var DontDoThis=false;
			var cItemParent=cItem.parentNode;
			while(cItemParent && !DontDoThis && !DoThisDiv) {
				if ((""+cItemParent.id).substr(0,7)=="FlowDiv") {
					DontDoThis=true;
				} else if ((""+cItemParent.id).substr(0,9)=="vmlfixdiv") {
					DoThisDiv=cItemParent;
				}
				cItemParent=cItemParent.parentNode;
			}
			if (DoThisDiv) {
				cItem=DoThisDiv.firstChild;
				if (DoThisDiv.getAttribute("widthSaved")=="1") {
					DoThisDiv.style.width=DoThisDiv.getAttribute("widthOri");
					DoThisDiv.style.height=DoThisDiv.getAttribute("heightOri");
				}
			} else {
				cItem=cItem.offsetParent;
			}
			if (!DontDoThis && cItem.getAttribute("widthSaved")=="1") {
				cItem.style.width=cItem.getAttribute("widthOri");
				cItem.style.height=cItem.getAttribute("heightOri");
			}
		}


		AllTables=document.getElementsByTagName("TABLE");
		for (i=0;i<AllTables.length;i++) {
			var cItem=AllTables[i];
			if (cItem.getAttribute("widthSaved")=="1") {
				AllTables[i].style.zoom="normal";
				AllTables[i].width=AllTables[i].getAttribute("widthOri");
			}
		}
		HasZoomedPrint=false;
	}
	if (SupportLandscapePrinting) {
		AllTables=document.getElementsByTagName("TABLE");
		for (i=0;i<AllTables.length;i++) {
			curID=""+AllTables[i].id;
			if (((curID.substr(0,5)=="tbSys") && (curID!="tbSysDokDefEmner")) || curID.substr(0,14)=="tableDokAfsnit") {
				AllTables[i].style.width=bodyWidth;
			}
			if (AllTables[i].getAttribute("AutoBreak")=="1") {
				AllTables[i].style.removeProperty("pageBreakBefore");
			}
			for (j=0;j<AllTables[i].rows.length;j++) {
				if (AllTables[i].rows[j].getAttribute("AutoBreak")=="1") {
					AllTables[i].rows[j].style.removeProperty("pageBreakBefore");
				}
			}
		}
	}
}

var CurDocLink=false;
var CurDocLinkRange=null;
function ClickDocLinksMD() {
	CurDocLinkRange=null;
	if (window.getSelection) {
	    var tSelect=window.getSelection();
		if (tSelect.rangeCount>0) {
			CurDocLinkRange=tSelect.getRangeAt(0);
		}
	} else if (document.selection && (document.selection.type.toLowerCase()=="text")) {
		CurDocLinkRange=document.selection.createRange();
	}
}
function ClickDocLinks(nDokID, nAfsnitID) {
	var nText=false;
	CurDocLink=false;
	if (!parent.fEdit) return false;
	if (window.getSelection) {
	    var tSelect=window.getSelection();
	    var tRange=(tSelect && tSelect.rangeCount>0?tSelect.getRangeAt(0):undefined);
		if (tRange) {
			var aNode=tSelect.anchorNode;
			var pElement=tRange.startContainer;
			if (!pElement.nodeType!=Node.ELEMENT_NODE) pElement=pElement.parentElement;
			var tFrag=tRange.cloneContents();
			nText=tFrag.textContent;
			if (tFrag.children.length==0 && tFrag.childNodes.length==1) {
				// Wrap in div to get encoded html-entities
				var h=document.createElement("DIV");
				h.textContent=tFrag.textContent;
				tFrag=h;
				nText=tFrag.innerHTML;
			}
			if (nText=="" && CurDocLinkRange && CurDocLinkRange.cloneContents) {
				tFrag=CurDocLinkRange.cloneContents();
				nText=tFrag.textContent;
			}
			var nHtml="";
			CurDocLink=nText;
			if (tFrag.childNodes.length>1) {
				for (var i=0;i<tFrag.childNodes.length;i++) {
					if (tFrag.childNodes[i].nodeType==1) {
						nHtml +=tFrag.childNodes[i].outerHTML;
					} else nHtml +=tFrag.childNodes[i].data;
				}
				if (nHtml.indexOf("ClickDocLinks")>0) nHtml="";
				nHtml=nHtml.replace(/[\s]+/g," ");
				if (!nHtml.match(/&[a-z]+;/)) nHtml=nHtml.replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;");
				CurDocLink=nHtml;
			}
			nText=encodeURIComponent(CurDocLink);
		}
	} else if (document.selection) {
	    if (document.selection.type.toLowerCase()=="text") {
	        var nRange=(CurDocLinkRange?CurDocLinkRange:document.selection.createRange());
	        var nText=nRange.text;
	        var nHtml=nRange.htmlText;
	        if (nHtml.indexOf("ClickDocLinks")>0) nHtml="";
	        nHtml=nHtml.replace(/[\r\n]*/g,"").replace(/&/g,"&amp;").replace(/&amp;amp;/g,"&amp;");
	        // alert("|"+nText+"|"+"\r"+nText.length+"\r"+cText+"\r|"+nHtml+"|"+"\r"+cHtml+"\r"+nHtml.indexOf(nText));
	        if (nText.length>1 && (nHtml.indexOf(nText)>-1)) {
	            CurDocLink=nText;
	        } else {
	            CurDocLink=nHtml;
	        }
	        nText=escape(CurDocLink);
	    }
	}
	if (parent.SetEditLocation) {
		parent.SetEditLocation('/D4Doc/bookedit/editlinks.asp?DokID='+nDokID+'&AfsnitID='+nAfsnitID+(nText ? '&nt=1':''));
	} else {
		parent.fEdit.document.location.href='/D4Doc/bookedit/editlinks.asp?DokID='+nDokID+'&AfsnitID='+nAfsnitID+(nText ? '&nt=1':'');
	}
	return false;
}
function GetDocLinks() {
	var thisDocLink=CurDocLink;
	CurDocLink=false;
	// alert(thisDocLink);
	return thisDocLink;
}
function SelectCurentItem(cEl) {
	if (document.selection) {
		document.selection.empty();
		var range = document.body.createTextRange();
		range.moveToElementText(typeof cEl =="String" ? document.getElementById(cEl) : cEl);
		range.select();
	} else if (window.getSelection) {
		window.getSelection().removeAllRanges();
		var range = document.createRange();
		range.selectNode(typeof cEl =="String" ? document.getElementById(cEl) : cEl);
		window.getSelection().addRange(range);
	}
}
var ExternalLinkTargetForced=false;
function TestLinkDestination() {
	try {
		if (window.event && window.event.srcElement) {
			var clickSrc=window.event.srcElement;
			if (clickSrc.tagName!="A") {
				while ((clickSrc.tagName!="A") && (clickSrc.tagName!="BODY") && clickSrc.parentElement) {
					clickSrc=clickSrc.parentElement;
				}
			}
			if (clickSrc.tagName=="A") {
				if (clickSrc.href) {
					if (!clickSrc.target || (ExternalLinkTargetForced==3) || (ExternalLinkTargetForced==2 && ((clickSrc.target).toLowerCase()=="_self"))) {
						var NewHREF=(""+clickSrc.href).toLowerCase();
						if ((NewHREF.indexOf("http://")>-1 || NewHREF.indexOf("https://")>-1) && (NewHREF.indexOf(document.domain)==-1)) {
							clickSrc.target="_blank";
						}
					}
				}
			}
		}
	} catch (e) {
	}
}

// Funktion til at vise popup med teksten fra destination for internt link
var getDestinationTextTO=false;
var getDestinationTextDiv=undefined;
function getDestinationTextShowStart(ev,inp) {
	if (getDestinationTextTO) window.clearTimeout(getDestinationTextTO);
	getDestinationTextTO=window.setTimeout( (function(){var e=ev,i=inp; return function(){getDestinationTextShow(e,i)}; })(),500);
}
function getDestinationTextShow(ev,inp) {
	if (!inp) return;
	var a=inp.getElementsByTagName("a");
	if (a.length>0) {
		var d=a[0].href;
		var h=d.substring(d.lastIndexOf("#")+1);
		var d=(document.getElementsByClassName?document.getElementsByClassName("spD4DocBody"+h):null);
		var t="";
		if (d && d.length>0) {
			t="<b>"+a[0].innerText+"</b>\r\n"+d[0].innerText;
		} else {
			var d=document.getElementsByName(h);
			if (d.length>0) {
				var h=d[0];
				if (h.parentElement.tagName=="TD") {
					h=h.parentElement.nextSibling;
					var t="<b>"+h.innerText+"</b>";
				} else {
					while (h.tagName=="A") h=h.nextSibling;
					if ( (h.tagName=="SPAN" && h.className=="rubBesNr") || (h.tagName=="B") ) {
						t += h.innerText;
						h=h.nextSibling;
					}
					if (h.tagName=="B")  {
						t += h.innerText;
						h=h.nextSibling;
					}
					if (h.tagName=="BR" || h.tagName=="DIV") {
						t += "\r\n";
						h=h.nextSibling;
					}
					if (h.tagName=="SPAN") t += h.innerText;
				}
			}
		}
		if (t!="") {
			var t=t.substring(0,4000).replace(/[\r\n]+/g,"<br>")+(t.length>4000?"...":"");
			CurrentPopUpSrc="getDestinationText";
			CurrentPopUpUid="";
			showPopUp("<div style=\"max-width:400px;max-height:200px;white-space:normal;overflow:auto\">"+t+"</div>",ev);
		}
	}
}
function getDestinationTextHide(ev,inp) {
	if (getDestinationTextTO) window.clearTimeout(getDestinationTextTO);
	hidePopUp();
}


// Visio Function <
var CurVisioItem=false;
function clickMenu(){}
function OnShapeClick(par0,par1) {
	CurVisioItem=window.event.srcElement;
	clickVMLDiv(CurVisioItem);
}

function OnShapeKey(PageID,ShapeID) {}
function UpdateTooltip(inpCnt,PageID,ShapeID) {
	CurVisioItem=inpCnt;
}
function UpdateProps(PageID,ShapeID) {}
function clickVMLDiv(inpCnt) {
	var Box=inpCnt;
	newHref=false;
	if (Box.orighref) {
		newHref=Box.orighref;
	} else if (Box.origHref) {
		newHref=Box.origHref;
	} else {
		Box=window.event.srcElement;
		if (Box.orighref) {
			newHref=Box.orighref;
		} else if (Box.origHref) {
			newHref=Box.origHref;
		}
	}
	if (newHref) {
		if (newHref.indexOf("frames")>-1) {
			if (top.fContentFrame) {
				window.event.cancelBubble=true;
				window.event.returnValue=false;
				top.fContentFrame.location.href=newHref;
			}
		} else {
			window.event.cancelBubble=true;
			window.event.returnValue=false;
			window.location.href=newHref;
			document.location.href=newHref;
		}
	}
//	alert(Box)
	Box=window.event.srcElement;
	if (Box.orighref) {
//		document.location.href=Box.href;
	}
	return false;
}
// Visio Function >

function cancelBubble(ev) {
	if (!ev) ev=window.event;
	if (ev) {
		ev.cancelBubble=true;
		ev.returnValue=false;
		if (ev.preventDefault) ev.preventDefault();
		if (ev.stopPropagation) ev.stopPropagation();
	}
}

function KeyDown(ev) {
	if (!ev) ev=window.event;
	var newKeyCode=(ev ? ev.which || ev.keyCode:undefined);
	if (ev && ev.ctrlKey && !ev.altKey) {
		if (sEdit=="1") {
			if (newKeyCode==48 || newKeyCode==96) {
				parent.fEdit.document.location.href="/D4Doc/bookedit/editframes.asp?DokID="+DokID;
			}
			if ((newKeyCode>48 && newKeyCode<58) || (newKeyCode>96 && newKeyCode<106)) {
				var cCode=newKeyCode-(newKeyCode>96?96:48);
				if (document.getElementById("pencil"+cCode)) document.getElementById("pencil"+cCode).click();
				cancelBubble(ev);
			}
		} else {

		}
	} else if (ev && ev.ctrlKey && ev.altKey) {
		if (newKeyCode==83) { // s
			if (top.focusSearch) top.focusSearch();
		}
	}
}


function ShowInWord() {
	var useFrame=(parent.fEdit && parent.fEdit.location?parent.fEdit:parent.fBody && parent.fBody.location?parent.fBody:window);
	var getGS="?DokID="+DokID+"&Preview=1&AsType=Word&uid="+UserID+"&tv="+(new Date()).valueOf();
	if (ShowDocInWord(document.location.pathname+getGS,0,0)!=1) {
		useFrame.document.location.href=document.location.pathname+getGS;
	}	
}

function arrGkAdd() {
}

function swapTableClass(inp,cls1,cls2) {
	if (inp && inp.parentNode) {
		while (inp.tagName!="TABLE" && inp.parentNode) {
			inp=inp.parentNode;
		}
		if (inp.tagName=="TABLE") {
			inp.className=(inp.className==cls1?cls2:cls1);
		}
	}
}
function swapTBodyClass(inp,cls1,cls2) {
	if (inp && inp.parentNode) {
		while (inp.tagName!="TBODY" && inp.parentNode) {
			inp=inp.parentNode;
		}
		if (inp.tagName=="TBODY") {
			var hasCls1=(inp.className.indexOf(cls1)>-1);
			inp.className=inp.className.replace(new RegExp("[\\s]*"+cls1,"g"),"").replace(new RegExp("[\\s]*"+cls2,"g"),"")+" "+(hasCls1?cls2:cls1);
		}
	}
}

function ShowDocInWord(strLocation,intOpenType, ShowError) {
	var objWord;
	var OpenSuccess=1;
	try {
		if (intOpenType==0 || intOpenType==1) {
			objWord = new ActiveXObject("Word.Application");
		} else {
			objWord = new ActiveXObject("Excel.Application");
		}
		objWord.Visible = true;
		if (strLocation.toLowerCase().indexOf("http")==-1) {
			strLocation = webProtocol + "://" + webServer + strLocation
		}
		if (intOpenType==0) {
			var newDoc=objWord.Documents.Open(strLocation,false,true,false); // 'FileName, ConfirmConversions, ReadOnly, AddToRecentFiles,
		} else if (intOpenType==1) {
			var newDoc=objWord.Documents.Add(strLocation,false); // 'Template, NewTemplate,
		} else {
			var newDoc=objWord.Workbooks.Open(strLocation,false,false); // 'FileName, UpdateLinks, ReadOnly,
		}
	} catch (e) {
		OpenSuccess=0;
		if (ShowError) {
			alert("Unable to start "(intOpenType==0 || intOpenType==1?"Word":"Excel")+"\r\nError: "+e.Number+": "+e.Description+"\r\nFile will be opened by download");
		}
	}
	return OpenSuccess;
}
function OpenDoc(strLocation,intOpenType) {
	var a = ShowDocInWord(strLocation,intOpenType, 1);
	return (a==1?false:true);
}

// Funktion-kald Word kan finde p at indstte i tekster. Disse to simple implementeringer viser/skjuler kommentaren
function msoCommentShow(aID,cID) {
	var cmt=document.getElementById(cID);
	if (cmt) {
		cmt.className= cmt.className.replace(/ msocomtxtShow/gi,"")+" msocomtxtShow";
	}
}
function msoCommentHide(cID) {
	var cmt=document.getElementById(cID);
	if (cmt) {
		cmt.className= cmt.className.replace(/ msocomtxtShow/gi,"");
	}
}

// vmlConv: Funktioner at omdanne VML billeder (v:shape med v:imagedata) til img tag.
function vmlConvGetAttrib(e,an,ad) {
	if (!e) return 0;
	var x=(an?e.getAttribute(an):ad);
	if (x===undefined || x===null) x=ad;
	var r=parseFloat(x);
	if (!isFinite(r)) return 0;
	if (typeof(x)=="string" && (x).substr(x.length-1,1)=="f") {
		r=r/65536;
	}
	return r;
}

function vmlConvImgLoaded(cBil,cDiv,cImg) {
	var b=cBil, d=cDiv,i=cImg;

	return function() {

		// strrelse p fuldt billede
		var Img_W=i.offsetWidth
		var Img_H=i.offsetHeight

		// strrelse p synlig boks
		var Bil_W=parseFloat(b.offsetWidth)
		var Bil_H=parseFloat(b.offsetHeight)

		var f = b.firstElementChild;

		var cl=vmlConvGetAttrib(f,"cropleft",f.cropLeft);
		var cr=vmlConvGetAttrib(f,"cropright",f.cropRight);
		var ct=vmlConvGetAttrib(f,"croptop",f.cropTop);
		var cb=vmlConvGetAttrib(f,"cropbottom",f.cropBottom);

		// Synlig del af billedet
		var Img_VisX=(1-(cl+cr))*Img_W
		var Img_VisY=(1-(ct+cb))*Img_H


		i.style.width=(Img_W*Bil_W/Img_VisX)+"px"
		i.style.height=(Img_H*Bil_H/Img_VisY)+"px"

		i.style.left="-"+((Img_W*Bil_W/Img_VisX)*cl)+"px"
		i.style.top="-"+((Img_H*Bil_H/Img_VisY)*ct)+"px"
		f.style.visibility="hidden";
		if (f.tagName=="IMG") f.style.display="none";
	}
}
// vmlConvShapeImages kaldes med et top element, som kan vre document element, hvorunder alle v:shape med v:imagedata skal "erstattes" med en span med img inden i 
function vmlConvShapeImages(startElem) {
	if (!startElem) startElem=document;
	var docElem=(startElem.ownerDocument?startElem.ownerDocument:startElem);
	if (!docElem) {
		print("vlmConv: no document element");
		return;
	}
	var dCount=0;
	var vShapes=startElem.getElementsByTagName("v:shape");
	for (var x=0;x<vShapes.length;x++) {
		var Bil=vShapes[x];
		if (Bil && Bil.firstElementChild) {
			var ImgSrc=Bil.firstElementChild.src;
			if (ImgSrc==undefined) ImgSrc=Bil.firstElementChild.getAttribute("src");
			if (Bil.previousElementSibling && Bil.previousElementSibling.tagName=="IMG" && Bil.previousElementSibling.src==ImgSrc)
				ImgSrc=undefined;
			if (ImgSrc!=undefined) {
				var p=Bil.getElementsByTagName("span");
				for (var y=p.length-1;y>-1;y--) {
					if (p[y].getAttribute("vmlConvDiv")=="1") {
						Bil.removeChild(p[y]);
					}
				}
				if (Bil.parentElement && Bil.parentElement.tagName=="SPAN") {
					Bil.parentElement.style.display="inline-block";
					Bil.parentElement.style.textIndent="0px";
				}
				var Div=docElem.createElement("span");
				Div.setAttribute("vmlConvDiv","1");
				Bil.insertBefore(Div,null);
				var Img=docElem.createElement("img");
				Div.insertBefore(Img,null);

				Div.style.width=Bil.offsetWidth+"px";
				Div.style.height=Bil.offsetHeight+"px";
				Div.style.overflow="hidden";
				Div.style.display="inline-block";
				Div.style.position="relative";
				Img.style.position="relative";

				Img.onload=vmlConvImgLoaded(Bil,Div,Img);
				Img.src=ImgSrc;
				dCount++;
			}
		}
	}
}

</script>
<meta name="d4-dokumentbruger-id" content="792,null,null,null,null">
<meta name="d4-dokumentbruger-navn" content="Eksterne samarbejdspartnere (SygH, Eksterne)">
<meta name="d4-dokumentbruger-id" content="199,null,null,null,null">
<meta name="d4-dokumentbruger-navn" content="Esbjerg Grindsted Sygehus (SygH, SVS)">
<meta name="d4-dokumentbruger1-id" content="1958,null,null,null,null">
<meta name="d4-dokumentbruger1-navn" content="Internettet (InfoNet Eksternt Site) (Ansv, Internet)">
<meta name="d4-dokbrugertype5" content="Eksterne samarbejdspartnere, Esbjerg Grindsted Sygehus">
<meta name="d4-dokbrugertype5Any" content="1">
<meta name="d4-dokbrugertype10" content="Internettet (InfoNet Eksternt Site)">
<meta name="d4-dokbrugertype10Any" content="1">

	<script type="text/javascript" language="javascript">
	<!--
	function initView() {
		if (document.documentMode!=9) { var a=document.getElementsByTagName("v:shape"); for (x=0;x<a.length;x++) {var b=a[x].getElementsByTagName("v:imagedata"); var c=a[x].getElementsByTagName("img"); if (b.length>0 && c.length==0) { if (b[0].getAttribute) {var i=document.createElement("img");try {i.src=(b[0].getAttribute("src")?b[0].getAttribute("src"):b[0].src);b[0].parentNode.insertBefore(i,b[0]);i.style.cssText=(a[x].style.cssText?a[x].style.cssText:"");b[0].style.display="none"} catch(duh) {} } else if (false) { alert(a[x].outerHTML) } }} }
	}
	function initPrinter() {	
	}
	//-->
	</script>
	
</head>
<body topmargin=5 leftmargin=5 onload="docResize();
	docLoaded(837589,8967,218,
				false,
				false,
				false,
				false,
				false,
				false,
				false,false,false,
				15,false);
	;
	initView();" onresize="docResize();setListeTop();" onkeydown="if(window.KeyDown) { return KeyDown(event) } else if (top.KeyDown) return top.KeyDown(event)" onbeforeunload="removeIcons()" onscroll="setListeTop(event)" onclick="return TestLinkDestination()" class="shadow DocOffline dsidskin rsdvskin  D4DocLeftSpace D4DocSkinnedDoc AsTypeOffline HasBodyClassCover " tabindex=0>
<div id="divBodyClassCover" class="divBodyClassCover hideScreen"></div><script type="text/javascript">if (!window.MaxZindex) 
	MaxZindex=5;

function initFlow(FlowID,CheckZoom,AsPrint) {
	var lHref=(""+window.location.href).toLowerCase();
	if ((window.name!="fContentFrame" && window.name!="fBody" && window.name.indexOf("StartPage")!=0 
			&& lHref.indexOf("flowmenu=0")==-1 && lHref.indexOf("showmenu=0")==-1 && lHref.indexOf("astype=print")==-1)
	 ||  (lHref.indexOf("flowmenu=1")>0) ||  (lHref.indexOf("showmenu=1")>0)) {
		if (document.getElementById && document.getElementById("divFlowTopMenu")) {
			document.getElementById("divFlowTopMenu").className="Shown";
			if (document.getElementById("divFlowTopMenuSpace")) document.getElementById("divFlowTopMenuSpace").className="Shown";
			// document.body.style.backgroundPosition="0px 24px";
			if (document.getElementById("divFlowTopShadow")) document.getElementById("divFlowTopShadow").style.top="24px";
		}
	}
	if (CheckZoom && FlowID) {
		resizeFlow(FlowID);
	}
}
function resizeFlow(FlowID,ndx,zoomTo) {
	if (!ndx) ndx="0";
	var cFlowZ=document.getElementById("FlowCnt_"+ndx+"_"+FlowID);
	var cFlow=document.getElementById("FlowDiv_"+ndx+"_"+FlowID);
	var cFlowCont=document.getElementById("divFlowContainer");
	var cFlowIsContainer;
	if (!cFlowZ && cFlow) cFlowZ=cFlow;
	if (!cFlow && cFlowCont) {
		cFlow=cFlowCont;
		cFlowIsContainer=true;
	}
	if (cFlow) {
		var oFlowHeight=cFlow.offsetHeight;
		var oriHeight=cFlow.getAttribute("oriHeight");
		if (!oriHeight) {
			cFlow.setAttribute("oriHeight",oFlowHeight);
			oriHeight=oFlowHeight;
		} else {
			oFlowHeight=oriHeight;
		}
		oFlowHeight = parseInt(oFlowHeight);
		if (!isFinite(oFlowHeight)) oFlowHeight = 0;
		var oFlowWidth=cFlow.offsetWidth;
		var oriWidth=cFlow.getAttribute("oriWidth");
		if (!oriWidth) {
			cFlow.setAttribute("oriWidth",oFlowWidth);
			oriWidth=oFlowWidth;
		} else {
			oFlowWidth=oriWidth;
		}
		oFlowWidth = parseInt(oFlowWidth);
		if (!isFinite(oFlowWidth)) oFlowWidth = 0;
		var dHeight=(document.documentElement?document.documentElement:document.body).clientHeight;
		var bHeight=document.body.clientHeight;
		var sHeight=document.body.scrollHeight;
		var wHeight=window.innerHeight;
		if (dHeight>bHeight) bHeight = dHeight;
		if (dHeight<bHeight && bHeight<sHeight) bHeight = dHeight;
		if (bHeight > wHeight) bHeight = wHeight;
		var dWidth = (document.documentElement?document.documentElement:document.body).clientWidth;
		var bWidth = document.body.clientWidth;
		var wWidth = window.innerWidth;
		if (dWidth<bWidth) bWidth = dWidth;
		if (bWidth > wWidth) bWidth = wWidth;
		var oExtraHeight=(document.getElementById("divFlowTopMenu") && document.getElementById("divFlowTopMenu").className.indexOf("Shown")>-1?document.getElementById("divFlowTopMenu").offsetHeight:0);
		var zoomToHori = zoomTo;
		var zoomToVert = zoomTo;
		if (!zoomTo) {
			if (window.D4DocFlowKeepZoom100) {
				zoomTo=100;
			} else {
				if (!window.D4DocFlowZoomMinH) D4DocFlowZoomMinH=80;
				if (!window.D4DocFlowZoomMaxH) D4DocFlowZoomMaxH=100;
				if (!window.D4DocFlowZoomMinV) D4DocFlowZoomMinV=50;
				if (!window.D4DocFlowZoomMaxV) D4DocFlowZoomMaxV=100;
				var newZoomH = Math.floor((bWidth/oFlowWidth)*100);
				var newZoomV = Math.floor(((bHeight-oExtraHeight)/oFlowHeight)*100);
				if (newZoomH<D4DocFlowZoomMinH) newZoomH=D4DocFlowZoomMinH;
				if (newZoomH>D4DocFlowZoomMaxH) newZoomH=D4DocFlowZoomMaxH;
				if (newZoomV<D4DocFlowZoomMinV) newZoomV=D4DocFlowZoomMinV;
				if (newZoomV>D4DocFlowZoomMaxV) newZoomV=D4DocFlowZoomMaxV;
                if (window.D4DocFlowZoomHori == 1 && window.D4DocFlowZoomVert == 0) {
					zoomTo = newZoomH;
					zoomToHori = newZoomH;
					zoomToVert = newZoomH;
				} else if (window.D4DocFlowZoomHori == 0 && window.D4DocFlowZoomVert == 1) {
					zoomTo = newZoomV;
					zoomToHori = newZoomV;
					zoomToVert = newZoomV;
				} else if (window.D4DocFlowZoomHori == 1 && window.D4DocFlowZoomVert == 1) {
					zoomTo = newZoomH;
					zoomToHori = newZoomH;
					zoomToVert = newZoomV;
                } else {
					zoomTo = (newZoomH<newZoomV?newZoomH:newZoomV);
					zoomToHori = (newZoomH<newZoomV?newZoomH:newZoomV);
					zoomToVert = zoomToHori;
                }

			}
		}
		if (!isFinite(zoomToHori)) zoomToHori = 100;
		if (!isFinite(zoomToVert)) zoomToVert = 100;
		console.log("body: "+bWidth+", "+bHeight+"  calc:"+(oFlowWidth * zoomToHori / 100)+"   flow: "+oFlowWidth+", "+oFlowHeight+"  zh:"+zoomToHori+"  zw:"+zoomToVert+"  z:"+zoomTo);
		if (zoomToHori == 100 && zoomToVert == 100) {
			cFlow.style.removeProperty("zoom");
			cFlow.style.transform = "";
			cFlow.style.removeProperty("transform");
			if (cFlowCont) {
				cFlowCont.style.width = oFlowWidth + "px";
				cFlowCont.style.height = oFlowHeight + "px";
			}
		} else if (cFlow.style.zoom!==undefined && (zoomToHori==zoomToVert) ) {
			if (cFlowCont) {
				cFlowCont.style.width=Math.round(oFlowWidth*zoomTo/100)+"px";
				cFlowCont.style.height=Math.round(oFlowHeight*zoomTo/100)+"px";
				cFlowCont.style.overflow=(zoomTo<100?"hidden":"");
			}
			cFlow.style.zoom=zoomTo+"%";
		} else {
			var sTrans=" translate("+(-((oFlowWidth/2)*(100-zoomToHori)/100))+"px, "+(-((oFlowHeight/2)*(100-zoomToVert)/100))+"px) scale("+(zoomToHori/100)+", "+(zoomToVert/100)+")";
			//cFlow.style.width=(oriWidth*zoomTo/100)+"px"
			//cFlow.style.height=(oriHeight*zoomTo/100)+"px"
			cFlow.style.transform=sTrans;
			console.log(sTrans);
			cFlow.style.removeProperty("zoom");
			if (cFlowCont) {
				cFlowCont.style.width = Math.round(oFlowWidth * zoomToHori / 100) + "px";
				cFlowCont.style.height = Math.round(oFlowHeight * zoomToVert / 100) + "px";
			}
		}
		var cd=document.getElementById("flowDivCurZoom");
		if (cd) cd.innerText=(zoomToHori==zoomToVert?zoomTo:zoomToHori+"/"+zoomToVert)+"%";
		// if (document.getElementById("divFlowContainer")) document.getElementById("divFlowContainer").style.overflow=(zoomTo<100?"hidden":"");
		if (document.getElementById("cntFlowCenter_"+ndx+"_"+FlowID)) {
			document.getElementById("cntFlowCenter_"+ndx+"_"+FlowID).style.width=Math.round(zoomToHori/100*oFlowWidth)+"px";
			// document.getElementById("cntFlowCenter_"+ndx+"_"+FlowID).style.height=Math.round(zoomToVert/100*oFlowHeight)+"px";
		}
	}
}

function highIcon(inp,iFile) {
	inp.src="/D4Doc/res/"+iFile+"_mo.gif";
}
function lowIcon(inp,iFile) {
	inp.src="/D4Doc/res/"+iFile+".gif";
}
function testPrint() {
	window.print();
}
var curPath="";
var curName="";
function testMail(inpDoc) {
	curName=window.title;
	curPath=window.location.href;
	try {
		curName=encodeURIComponent(curName);
		curPath=encodeURIComponent(curPath);
	}
	catch (e) {
		curName=escape(curName);
		curPath=escape(curPath);
	}
	fbWin=window.open("/D4Doc/book/feedback.asp?BookID="+BookID+"&DokID=0&cURL="+curPath+"&cTitle="+curName,"feedback","width=500,height=400,scrollbars=no,resizable=yes,toolbar=no,status=no,location=no");
}

function DontBubble(ev) {
	if (!ev) ev=window.event;
	if (ev) {
		ev.cancelBubble=true;
		if (ev.stopPropagation) ev.stopPropagation();
	}
	return false;
}
function CancelEvent(ev,allowBubble) {
	if (!ev) ev=window.event;
	if (ev) {
		ev.returnValue=false;
		if (ev.preventDefault) ev.preventDefault();
		if (!allowBubble) {
			ev.cancelBubble=true;
			if (ev.stopPropagation) ev.stopPropagation();
		}
	}
	return false;
}
function ParseIntArray(inp) {	// Kontroller om en kommasepareret liste af tal, nu ogs er tal
	// Returnerer en kommasepareret liste over tallene. "" hvis ingen tal
	inp = "" + inp;
	inp = inp.split(",");
	for (var i = inp.length - 1; i >= 0; i--) {
		inp[i] = parseInt(inp[i], 10);
		if (!isFinite(inp[i]) || isNaN(inp[i])) {
			inp.splice(i, 1);
		}
	}
	inp = inp.join(",");
	if (inp == "NaN") inp = "";
	return inp;
}

function getFlowClick(ev) {
	if (!ev) ev=window.event;
	if (!ev) return;
	var evTarget=(event.target?event.target:event.srcElement);
	if (evTarget && ""+evTarget.tagName!="A") {
		var curEl=evTarget;
		/*if (!curEl.href) {
		    curEl.href = "";
		}*/
		if (!curEl.href || (curEl.tagName=="IMG")) { //|| curEl.href != ""
			var nHref=""+curEl.href;
			var curP=curEl.parentNode;
			while (curP.parentNode && curP.tagName!="A" && curP.tagName!="BODY") {
				curP=curP.parentNode;
			}
			if (curP.tagName=="A") {
				try {
					curP.click();
				} catch (e) {
					return true;
				}
			    CancelEvent(ev,false);
				return DontBubble(ev);
			}
			if (nHref.indexOf("mailto:")!=0) {
//						document.location.href=nHref;
			}
			return false;
		}
	}
//			alert(window.event.srcElement.offsetHeight);
}
function getFlowClick1(ev,inp,clickID) {
	if (!ev) ev=window.event;
	if (!ev) return;
	var evTarget=(event.target?event.target:event.srcElement);
	if (evTarget) {
	    if ((!evTarget.href || (evTarget.tagName == "IMG" || evTarget.tagName == "TD")) && !evTarget.useMap) {
			var curEl=evTarget;
			if (!curP) curP=curEl.parentNode;
			while (curP.parentNode && curP.tagName!="A" && curP.tagName!="BODY") {
				curP=curP.parentNode;
			}
			if (curP.tagName=="A") {
				curEl=curP;
				try {
					curEl.click();
				} catch (e) {
					return true;
				}
			    CancelEvent(ev,false);
				return DontBubble(ev);
			}
			var curP = document.getElementById("flow" + clickID+"_lnk");
			if (curP && ev.shiftKey) {
				window.open(curP.href,"_blank");
			    CancelEvent(ev,false);
				return DontBubble(ev);
			}
			if (curEl.href && !curEl.target) {
				DontBubble(ev);
			}
		}
	} else if (false && inp && clickID) {
		var a=document.getElementById("flow"+clickID+"_lnk");
		if (a) {
			DontBubble(ev);
			a.click();
			CancelEvent(ev,false);
		}
	}
}

var ScriptCount=0;
var ChangeCursor=false;
function dynamicLoadJS(scriptSrc) {	
	var head = document.getElementsByTagName("head")[0];	
	script = document.createElement('script');	
    script.id = "DynaScript"+ScriptCount;	
	script.type = 'text/javascript';	
	script.src = scriptSrc;	
	if (ChangeCursor)
		document.body.style.cursor="wait";
	head.appendChild(script);
	ScriptCount++;
}
function GetDocumentText(FlowNodeID,DokID, tPopup,DokAfsnitNr) {
	dynamicLoadJS("/D4/Resources/Asp/GetDocContent.asp?DokID="+DokID+"&ga=0&type="+tPopup+"&Nr="+DokAfsnitNr+"&cb=ReturnDocumentText(\""+FlowNodeID+"\",\"$\")");
}
function ReturnDocumentText(FlowNodeID,PopupContent) {
	if (curPopupControl && curPopupControl.id==FlowNodeID) {
		curPopupControl.setAttribute("curPopup",PopupContent);
		showFlowPopupDo();
	}
}

function getItemOffset(opCnt,xPos,yPos) {
	if (xPos==undefined) xPos=0;
	if (yPos==undefined) yPos=0;
	var curZoom=parseFloat(opCnt.style.zoom);
	if (!isFinite(curZoom)) {
		curZoom=100;
	} else if ((""+opCnt.style.zoom).indexOf("%") == -1) {
		curZoom = curZoom * 100;
	}
	xPos+=opCnt.offsetLeft*curZoom/100;
	yPos+=opCnt.offsetTop*curZoom/100;
	while (opCnt.offsetParent) {
		opCnt=opCnt.offsetParent;
		curZoom = parseFloat(opCnt.style.zoom);
		if (!isFinite(curZoom)) {
			curZoom=100;
		} else if (("" + opCnt.style.zoom).indexOf("%") == -1) {
			curZoom = curZoom * 100;
		}
		xPos=xPos*curZoom/100;
		yPos=yPos*curZoom/100;
		xPos+=opCnt.offsetLeft;
		yPos+=opCnt.offsetTop;
	}
	return [xPos,yPos];
}

function getObjOffsetArray(inpObj, stopAtObj, stopAtAbsolute) {
	if (!inpObj) return false;
	var objPos=new Array(0,0,inpObj.offsetWidth,inpObj.offsetHeight);
	var obj=inpObj;
	if (!stopAtObj && !stopAtAbsolute && inpObj.getBoundingClientRect) {
		var newPos=inpObj.getBoundingClientRect();
		objPos[0]=newPos.left+(document.documentElement && document.documentElement.scrollTop>0?document.documentElement.scrollLeft:document.body.scrollLeft);
		objPos[1]=newPos.top+(document.documentElement && document.documentElement.scrollTop>0?document.documentElement.scrollTop:document.body.scrollTop);
	} else {
		do {
			if (stopAtObj && obj===stopAtObj) return objPos;
			if (stopAtAbsolute) {
				var cPos;
				if (window.getComputedStyle) cPos = getComputedStyle(obj, null).position;
				else if (obj.currentStyle) cPos = obj.currentStyle.position;
				else if (obj.runtimeStyle) cPos = obj.runtimeStyle.position;
				else cPos = obj.style.position;
				if (cPos=="absolute" || cPos=="fixed") return objPos;
			} 
			objPos[0] += obj.offsetLeft;
			objPos[1] += obj.offsetTop;
		} while (obj = obj.offsetParent);
	}
	return objPos;
}

function getItemOffsetHtml(opCnt,xPos,yPos,StopAtFlowContainer) {
	if (xPos==undefined) xPos=0;
	if (yPos==undefined) yPos=0;
	var curZoom = parseFloat(opCnt.style.zoom);
	if (!isFinite(curZoom)) {
		curZoom=100;
	} else if (("" + opCnt.style.zoom).indexOf("%") == -1) {
		curZoom = curZoom * 100;
	}
	xPos+=opCnt.offsetLeft*curZoom/100;
	yPos+=opCnt.offsetTop*curZoom/100;
	while (opCnt.offsetParent || (opCnt.tagName=="MAP" && opCnt.parentElement)) {
		if (!opCnt.offsetParent) {
			opCnt=opCnt.parentElement;
		} else opCnt=opCnt.offsetParent;
		curZoom=parseFloat(opCnt.style.zoom);
		if (!isFinite(curZoom)) {
			curZoom=100;
		} else if (("" + opCnt.style.zoom).indexOf("%") == -1) {
			curZoom = curZoom * 100;
		}
		xPos=xPos*curZoom/100;
		yPos = yPos * curZoom / 100;
		if (StopAtFlowContainer && opCnt.className == "d4FlowContainer") break;
		xPos+=opCnt.offsetLeft;
		yPos+=opCnt.offsetTop;
	}
	return [xPos,yPos];
}

function getItemOffsetSvg(opCnt,xPos,yPos) {
	if (xPos==undefined) xPos=0;
	if (yPos==undefined) yPos=0;
	var cntPos = opCnt.getBoundingClientRect();
	var vpPos = getVpPos(opCnt);

	function getVpPos(el) {
		if(el.parentNode.nodeName === 'svg') {
			return el.parentNode.getBoundingClientRect();
		}
		return getVpPos(el.parentNode);
	}
	return [xPos+cntPos.left - vpPos.left,yPos+cntPos.top - vpPos.top,
		cntPos.width,cntPos.height]
};

function getItemOffsetSvgAttrib(opCnt,xPos,yPos) {
	if (xPos==undefined) xPos=0;
	if (yPos==undefined) yPos=0;
	var orPos=opCnt.getAttribute("orpoint");
	var tgPos=opCnt.getAttribute("tgpoint");
	if (orPos && tgPos) {
		orPos=orPos.split(",");
		tgPos=tgPos.split(",");
		if (orPos.length==2 && tgPos.length==2) {
			orPos[0]=parseInt(orPos[0],10);
			orPos[1]=parseInt(orPos[1],10);
			tgPos[0]=parseInt(tgPos[0],10);
			tgPos[1]=parseInt(tgPos[1],10);
			if (isFinite(orPos[0]) && isFinite(tgPos[0])) {
				xPos+=(tgPos[0]<orPos[0]?tgPos[0]:orPos[0]);
			}
			if (isFinite(orPos[1]) && isFinite(tgPos[1])) {
				yPos+=(tgPos[1]<orPos[1]?tgPos[1]:orPos[1]);
			}
		}
	}
	return [xPos,yPos,
		(tgPos[0]<orPos[0]?orPos[0]-tgPos[0]:tgPos[0]-orPos[0]),
		(tgPos[1]<orPos[1]?orPos[1]-tgPos[1]:tgPos[1]-orPos[1])]
};

var toFlowPopupHide;
var toShowFlowPopupDo;
var iFlowPopup=false;
var curPopupControl=null;
var nextPopupControl=null;
var curPopupShowing=false;
var curFlowItemWidth=0;
var curFlowItemHeight=0;
function showFlowPopup(iCnt,iEv,CurFlow,FlowID,Left,Top,Width,Height) {
	clearhideFlowPopup();
	if (iCnt!=curPopupControl && iCnt!=nextPopupControl && toShowFlowPopupDo) {
		clearShowFlowPopup();
	}
	if (!iEv) {
		iEv=window.event;
	}
	if (!iFlowPopup) {
		iFlowPopup = document.getElementById("FlowPopup");
		if (!iFlowPopup) {
			iFlowPopup = document.createElement("div");
			iFlowPopup.id="FlowPopup";
			iFlowPopup.style.position="absolute";
			iFlowPopup.style.top="0px";
			iFlowPopup.style.left="0px";
			iFlowPopup.style.width="200px";
			iFlowPopup.style.display="none";
			iFlowPopup.style.overflow="visible";
			iFlowPopup.style.textAlign = "left";
			iFlowPopupDiv = document.createElement("div");
			iFlowPopupDiv.id = "FlowPopupDiv";
			iFlowPopupDiv.className = "FlowPopupDiv";
			iFlowPopupDiv.zIndex = 987654;
			if (iFlowPopupDiv.addEventListener) {
				iFlowPopupDiv.addEventListener('click', function() {return getPopupClick(this)} );
				iFlowPopupDiv.addEventListener('mouseover', function() {return clearhideFlowPopup(this)} );
				iFlowPopupDiv.addEventListener('mouseout', function() {return hideFlowPopup(this)} );
			} else if (iFlowPopupDiv.attachEvent) {
				try {
					iFlowPopupDiv.attachEvent('onclick', function() {return getPopupClick(this)} );
					iFlowPopupDiv.attachEvent('onmouseover', function() {return clearhideFlowPopup(this)} );
					iFlowPopupDiv.attachEvent('onmouseout', function() {return hideFlowPopup(this)} );
				} catch(e) {
				} 
			}
			iFlowPopup.insertBefore(iFlowPopupDiv, null);
			document.body.insertBefore(iFlowPopup, null);
		}
	}
	nextPopupControl=iCnt;
	if (iFlowPopup) {
		if (!Width) Width=iCnt.offsetWidth;
		if (!Height) Height=iCnt.offsetHeight;
		hasPosition=false;
		toShowFlowPopupDo=window.setTimeout((function(ev,idim) {var evt=ev, idm=idim;  return function() {showFlowPopupTO(evt,idm)}})(iEv,[Left,Top,Width,Height]),250);
	}
}
function clearShowFlowPopup() {
	window.clearTimeout(toShowFlowPopupDo);
	toShowFlowPopupDo=undefined;
}

function showFlowPopupTO(iEv,boxDim) {
	if (curPopupControl!=nextPopupControl) {
		curPopupControl=nextPopupControl;
		var iCnt=curPopupControl;
		var curPopup=iCnt.getAttribute("curPopup");
		if (curPopup) {
			if (boxDim) {
				curFlowItemWidth=boxDim[2];
				curFlowItemHeight=boxDim[3];
			}
			var DokAfsnitNr="";
			var cDokID=0;
			if (typeof cDokID != "undefined")
				cDokID = DokID;
			var tPopup="";
			if (curPopup.toLowerCase().substr(0,7)=="=dokid=") {
				cDokID=parseInt(curPopup.substring(7,curPopup.indexOf("#")),10);
				if (isFinite(cDokID)) {
					tPopup=curPopup.substr(curPopup.indexOf("#")+1).toLowerCase();
				}
			} else if (curPopup.substr(0,2)=="=#") {
				tPopup=curPopup.substr(2).toLowerCase();
			}
			if (tPopup.substr(0,2)=="nr") {
				DokAfsnitNr = ParseIntArray(tPopup.substr(2).replace(".",","));
				tPopup="nr";
			}
			if (DokAfsnitNr!="") {
				dohideFlowPopup(true);
				GetDocumentText(iCnt.id,cDokID,tPopup,DokAfsnitNr);
			} else {
				showFlowPopupDo();
			}
		}
	}
}
function showFlowPopupDo() {
	// try {
		var iCnt=curPopupControl;
		if (iCnt) {
			var curPopup=iCnt.getAttribute("curPopup");
			var curPopupX=parseInt(iCnt.getAttribute("curPopupX"),10);
			if (curPopupX==null) curPopupX=parseInt(iCnt.getAttribute("curpopupx"),10);
			if (!isFinite(curPopupX) || curPopupX==null) curPopupX=0;
			var curPopupY=parseInt(iCnt.getAttribute("curPopupY"),10);
			if (!isFinite(curPopupY)) curPopupY=parseInt(iCnt.getAttribute("curpopupy"),10);
			if (!isFinite(curPopupY) || curPopupY==null) curPopupY=0;
			var curPopupW=parseInt(iCnt.getAttribute("curPopupW"),10);
			if (!isFinite(curPopupW)) curPopupW=parseInt(iCnt.getAttribute("curpopupw"),10);
			if (!isFinite(curPopupW) || curPopupW==null) curPopupW=0;
			var LinkTarget=iCnt.getAttribute("LinkTarget");
			var LinkHref=iCnt.getAttribute("LinkHref");
			var xPos=0;
			var yPos=0;
			var wDim=0;
			var IsVertex=(iCnt.className.indexOf("Vertex")>-1);
			if (curPopupX==0 && curFlowItemWidth>0) curPopupX=(IsVertex?curFlowItemWidth/2:curFlowItemWidth-(curFlowItemWidth>100?20:0));
			if (curPopupY==0 && curFlowItemHeight>0) curPopupY=(IsVertex?curFlowItemHeight/2:curFlowItemHeight-(curFlowItemHeight>50?10:0));
			if (curPopupW==0) curPopupW=250;
			var itemPos = [0, 0];
			if (iCnt.parentNode.nodeName === 'svg') {
				itemPos = getItemOffsetSvgAttrib(iCnt);
				xPos = itemPos[0] + curPopupX;
				yPos = itemPos[1] + curPopupY;
			} else {
				itemPos = getItemOffsetHtml(iCnt, curPopupX, curPopupY, false);
				xPos = itemPos[0];
				yPos = itemPos[1];
			}

			iFlowPopup.style.left=xPos+"px";
			iFlowPopup.style.top=yPos+"px";
			iFlowPopup.style.zIndex=MaxZindex;
			iFlowPopup.style.width="auto";
			iFlowPopup.style.display="block";
			curPopupShowing=true;
			if (LinkHref) {
				iFlowPopup.firstChild.innerHTML="<table cellspacing=0 cellpadding=0 border=0 width='100%'>"+
				"<tr><td id='curPopupText' FlowItem='"+iCnt.id+"'>"+curPopup+
				"<table cellspacing=0 cellpadding=0 border=0 width=20 align=right>"+
				"<tr><td><a class='popuplink' FlowItem='' "+(LinkTarget?"target='"+LinkTarget+"' ":"")+"href='"+LinkHref+"'>[...]</a></td></tr></table></td></tr></table>";
			} else {
				iFlowPopup.firstChild.innerHTML="<div id='curPopupText' FlowItem='"+iCnt.id+"'>"+curPopup+"</div>";
			}
			iFlowPopup.style.width=curPopupW+"px";
			if (iFlowPopup.offsetWidth<iFlowPopup.firstChild.scrollWidth) iFlowPopup.style.width=(iFlowPopup.firstChild.scrollWidth+6)+"px";
		}
	// } catch (e) {}
}
function showFlowPopupArea(iCnt,iEv,CurFlow,FlowID,Left,Top,Width,Height) {
	showFlowPopup(iCnt,iEv,CurFlow,FlowID,Left,Top,Width,Height);
	if (iEv.stopPropagation) iEv.stopPropagation();
}
function dohideFlowPopup(keepCurrent) {
	clearhideFlowPopup();
	if (iFlowPopup && curPopupShowing) {
		iFlowPopup.style.display="none";
		iFlowPopup.firstChild.innerHTML="";
		curPopupShowing=false;
		if (!keepCurrent) curPopupControl=undefined;
	}
}
function hideFlowPopup() {
	clearhideFlowPopup();
	toFlowPopupHide=window.setTimeout("dohideFlowPopup()",1000);
}
function clearhideFlowPopup() {
	clearShowFlowPopup();
	if (toFlowPopupHide)
		window.clearTimeout(toFlowPopupHide);
	toFlowPopupHide=false;
}
function getPopupClick(iCnt) {
}

function testZoom(inpCntrl,ev,divID,FlowID,ndx) {
	var cFlow=inpCntrl;
	if (divID) {
		cFlow=document.getElementById("FlowDiv_"+divID);
	} else {
		if (!ndx) ndx="0";
		cFlow=document.getElementById("FlowDiv_"+ndx+"_"+FlowID);
	}
	if (cFlow) {
		var curZoom = parseFloat(cFlow.style.zoom);
		if (!isFinite(curZoom)) {
			curZoom=100;
		} else if ((("" + cFlow.style.zoom).indexOf("%") == -1) && (("" + inpCntrl.style.zoom).indexOf("%") == -1)) {
			curZoom = curZoom * 100;
		}
		if (curZoom > 1000) {
			curZoom = 1000;
        } else if (curZoom < 1) {
			curZoom = 1;
        }
		if (!ev) ev=window.event;
		if (ev.keyCode==42) {
			cFlow.style.zoom="100%";
		} else if (ev.keyCode==43) {
			cFlow.style.zoom=""+(curZoom+5)+"%";
		} else if (ev.keyCode==45 && (curZoom>5)) {
			cFlow.style.zoom=""+(curZoom-5)+"%";
		}
		var cd=document.getElementById("flowDivCurZoom");
		if (cd) cd.innerText=curZoom+"%";
	}
}
function FlowAntsShow(inp) {
//	try {
	if (inp.childNodes.length>1) {
		inp.childNodes[1].style.border="dotted 1px #999999";
	} else if (inp.childNodes.length>0 && inp.firstChild.tagName) {
		inp.firstChild.style.border="dotted 1px #999999";
	} else if (inp.childNodes.length>0 && inp.firstChild.firstChild>0) {
		inp.firstChild.firstChild.style.border="dotted 1px #999999";
	}
//	} catch (e) {}
}
function FlowAntsHide(inp) {
//	try {
	if (inp.childNodes.length>1) {
		inp.childNodes[1].style.border="0";
	} else if (inp.childNodes.length>0 && inp.firstChild.tagName) {
		inp.firstChild.style.border="0";
	} else if (inp.childNodes.length>0 && inp.firstChild.firstChild>0) {
		inp.firstChild.firstChild.style.border="0";
	}
//	} catch (e) {}
}

function ClickItem(inpTag,newSrc) {
	var curWin=window;
	if (!curWin.name || curWin.name.indexOf("!")>-1) curWin=curWin.parent;
	if (newSrc.indexOf("bookframes")>-1) {
		target="fContentFrame";
	} else {
		target="fBody";
	}
	if (curWin.name.indexOf("!")>-1) {
		curWin.name="fBody";
	}
	if (curWin.name==target) {
		curWin.location.href=newSrc;
	} else if (curWin.parent.name==target) {
		curWin.parent.location.href=newSrc;
	} else if (curWin.parent.parent.name==target) {
		curWin.parent.parent.location.href=newSrc;
	} else {
		curWin.location.href=newSrc;
	}
	return false;
}
function CheckVertSvg(id,vertAlign,Upright,horAlign) {
	var fItem=document.getElementById(id+"_RotDiv");
	if (fItem) {
		// try {
			var fTextItem=fItem;
			var fParent=fTextItem.parentNode;
			if (fParent.tagName=="A") fParent=fParent.parentNode;
			var fContent=fTextItem.firstElementChild;
			if (vertAlign=="top") {
				// alert(fTextItem.tagName);
				if (fTextItem) {  // fTextItem.style.top=0px;
					if (Upright) { 
					} else {
						// fTextItem.style.paddingRight = (fTextItem.parentNode.offsetWidth - fTextItem.offsetWidth - fTextItem.offsetLeft) + "px";
					}
				}
			} else if (vertAlign=="middle") {
				// alert(fTextItem.tagName);
				if (fTextItem) {
					if (Upright) { 
						if (fContent && fContent.scrollHeight > fTextItem.offsetHeight && fContent.offsetHeight > fTextItem.offsetHeight)
							fTextItem.style.top=((fTextItem.offsetHeight-(fContent.scrollHeight>fContent.offsetHeight?fContent.scrollHeight:fContent.offsetHeight))/2)+"px";
					} else {
						// fTextItem.style.marginLeft=Math.round((fTextItem.parentNode.offsetWidth-fTextItem.offsetWidth-fTextItem.offsetLeft )/2)+"px";
						if (fTextItem.offsetLeft + fTextItem.offsetWidth >= fTextItem.parentNode.offsetWidth - 1)
							fTextItem.style.paddingRight = Math.round((fTextItem.parentNode.offsetWidth - fTextItem.offsetWidth) / 2) + "px";
					}
				}
			} else if (vertAlign=="bottom") {
				// alert(fTextItem.tagName);
				if (fTextItem) {
					if (Upright) { 
						if (fContent && fContent.scrollHeight > fTextItem.offsetHeight && fContent.offsetHeight > fTextItem.offsetHeight)
							fTextItem.style.top=(fTextItem.offsetHeight-(fContent.scrollHeight>fContent.offsetHeight?fContent.scrollHeight:fContent.offsetHeight))+"px";
					} else {
						fTextItem.style.paddingRight = (fTextItem.parentNode.offsetWidth - fTextItem.offsetWidth) + "px";
					}
				}
			}
			if (Upright && fContent && fContent.scrollWidth>fTextItem.offsetWidth) { 
				if (horAlign=="center") {
					fTextItem.style.left=Math.round((fTextItem.offsetWidth-(fContent.scrollWidth>fContent.offsetWidth?fContent.scrollWidth:fContent.offsetWidth)-fTextItem.offsetLeft )/2)+"px";
				} else if (horAlign=="right") {
					fTextItem.style.left=Math.round((fTextItem.offsetWidth-(fContent.scrollWidth>fContent.offsetWidth?fContent.scrollWidth:fContent.offsetWidth)-fTextItem.offsetLeft ))+"px";
				} else {
					fTextItem.style.left="0px";
				}
			}
		// }catch (e) {}
	}
}


function CheckVert(id,vertAlign,Upright,horAlign) {
	var fItem=document.getElementById(id);
	if (fItem) {
		try {
			var fTextItem=fItem.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild;
			var fTableItem=fItem.firstChild.firstChild;
			var fCellItem=fTableItem.firstChild.firstChild.firstChild;
			var fContent=fCellItem.firstElementChild;
			if (true) {
				var imgs=fTextItem.getElementsByTagName("img");
				for (var ix=0;ix<imgs.length;ix++) {
					if (imgs[ix].outerHTML.indexOf(" height")==-1 && imgs[ix].outerHTML.indexOf(" width")>-1 && imgs[ix].outerHTML.indexOf("OriHeight")>-1) {
						var nHeight=parseInt(imgs[ix].getAttribute("width")*imgs[ix].getAttribute("OriHeight")/imgs[ix].getAttribute("OriWidth"),10);
						if (isFinite(nHeight)) imgs[ix].setAttribute("height",nHeight);
					}
				}
			}
			if (vertAlign=="top") {
				// alert(fTextItem.tagName);
				if (fTextItem) {
					if (Upright) {
					} else {
						if (fTextItem.parentNode.offsetWidth-fTextItem.offsetWidth-fTextItem.offsetLeft-fTextItem.offsetLeft>0) {
							fTextItem.style.left=(fTextItem.parentNode.offsetWidth-fTextItem.offsetWidth-fTextItem.offsetLeft-fTextItem.offsetLeft)+"px";
						} else if (fTableItem.offsetWidth>fItem.firstChild.offsetWidth) {
							fCellItem.style.left=(fItem.firstChild.offsetWidth-fTableItem.offsetWidth)+"px";
						}
					}
				}
			} else if (vertAlign=="middle") {
				// alert(fTextItem.tagName);
				if (fTextItem) {
					if (Upright) {
						if (fItem.firstChild.offsetHeight<fTextItem.offsetHeight-fTextItem.offsetTop-fTextItem.offsetTop) {
							fTableItem.style.position="relative";
							fTableItem.style.top=Math.round((fItem.firstChild.offsetHeight-fTextItem.offsetHeight-fTextItem.offsetTop-fTextItem.offsetTop)/2)+"px";
						} else if (fTableItem.offsetHeight>fItem.firstChild.offsetHeight) {
							fTableItem.style.top=Math.round((fItem.firstChild.offsetHeight-fTableItem.offsetHeight)/2)+"px";
						}
					} else {
						if (fTableItem.offsetWidth>fItem.firstChild.offsetWidth) {
							fCellItem.style.left==Math.round((fItem.firstChild.offsetWidth-fTableItem.offsetWidth)/2)+"px";
						} else if (fTextItem.parentNode.offsetWidth>fTextItem.offsetWidth) {
							fTextItem.style.left=Math.round((fTextItem.parentNode.offsetWidth-fTextItem.offsetWidth-fTextItem.offsetLeft-fTextItem.offsetLeft)/2)+"px";
						}
					}
				}
			} else if (vertAlign=="bottom") {
				// alert(fTextItem.tagName);
				if (fTextItem) {
					if (Upright) {
						if (fTableItem.offsetHeight>fItem.firstChild.offsetHeight) {
							fTableItem.style.position="relative";
							fTableItem.style.top=(fItem.firstChild.offsetHeight-fTableItem.offsetHeight)+"px";
						}
					}
				}
			}
			if (Upright && fContent && fTableItem.scrollWidth>fItem.offsetWidth) { 
				if (horAlign=="center") {
					fTableItem.style.position="relative";
					fTableItem.style.left=Math.round((fItem.firstChild.offsetWidth-fTableItem.scrollWidth-fItem.firstChild.offsetLeft )/2)+"px";
				} else if (horAlign=="right") {
					fTableItem.style.position="relative";
					fTableItem.style.left=Math.round((fItem.firstChild.offsetWidth-fTableItem.scrollWidth-fItem.firstChild.offsetLeft ))+"px";
				} else {
					fTableItem.style.position="relative";
					fTableItem.style.left="0px";
				}
			}

		} catch (e) {}
	}
}
</script>
	<script type="text/javascript" language="javascript">
	<!--
		MaxZindex=0;

	// -->
</script>
<style type="text/css">
		@import url("css/isoflow20251210.css");
		@import url("D4/Resources/Skins/Customer/css/FlowNet.css");
		@import url("D4/Resources/Skins/D42019RSyd/css/FlowNet20251210.css");
			@import url("D4/Resources/Skins/D42019RSyd/css/isoflow20251210.css");
			@import url("D4/Resources/Skins/D42019RSyd/css/FlowNet20251210.css");
			@import url("D4/Resources/Skins/D42019RSyd/css/isoflow20251210.css");
		</style><div id="PopUpTable" style="position:absolute; display:none; visibility:hidden; left:-300px;top:0;z-index:999999" onmouseover="letsKeepPopUp()" onmouseout="hidePopUp()"><table class="tbSysPopup" cellspacing=0 cellpadding=2 id="tbSysPopup"><tr><td id="PopUpThingy" class="popup" nowrap></td></tr></table></div><div id="divDocCrumb"><p class="small hideScreen" id="documentCrumb837589"><a href="https://infonet.regionsyddanmark.dk/?BookID=0&HGruppeID=12" target="_top">Esbjerg og Grindsted Sygehus</a> &nbsp;-&nbsp; <a href="https://infonet.regionsyddanmark.dk/?BookID=218" target="_top">Laboratorieinformation KMA, SVS</a> &nbsp;-&nbsp; <a href="https://infonet.regionsyddanmark.dk/?BookID=218&AfsnitID=8967" target="_top">1 Analyser</a></p></div><div class="dsidPageWrap">
				<div class="dsidPageBaseTopLeft" id="dsidPageBaseTopLeft837589"></div><div class="dsidPageBaseTopRight" id="dsidPageBaseTopRight837589"></div>
				<div class="dsidPageBaseBotLeft"></div><div class="dsidPageBaseBotRight"></div>
				<div class="dsidPageOverBotLeft"></div><div class="dsidPageOverBotRight"></div>
				<div class="dsidPageBaseTopCent" id="dsidPageBaseTopCent837589"></div><div class="dsidPageBaseBotCent"></div>
				<div class="dsidPageBaseLeft"></div><div class="dsidPageBaseRight"></div>
				<div class="dsidTextColWrap"><div class="dsidTextCol">
				<div class="dsidInfoBox " onclick="dsidOnDocHeadMouseClick(this,'837589')" onmouseout="doOnDocHeadMouseOut(this,837589)">
				<div class="dsidInfoBoxPosition" onmouseover="doOnDocHeadMouseOver(this,837589)"><span class="spDocInfoI hidePrint"><img src="res/info.gif" width=10 height=10 alt="Info" title="info" align=left class="small hidePrint"></span><div id="docInfo837589" onclick="cancelBubble(event)" class="small hidePrint docInfoDiv" style="position:absolute;top:20px;left:-0px;display:none;">
	<table><tr><td valign=top colspan=2 nowrap><p class=small8><b>Dokument-ID:</b> 837589<br>&nbsp;</p></td></tr><tr><td valign=top nowrap style="padding-right:30px;">
	<p class=small><b>Dokumentfunktioner</b></p>
	<script type="text/javascript" language="javascript">
			function printDocTest() {
				try {
					if (document.getElementById('docInfo837589')) document.getElementById('docInfo837589').style.display='none';
					if (document.queryCommandSupported && document.queryCommandSupported('print')) {
						document.execCommand('print', false, null);
					} else {
						window.print();
					}
					return false;
				} catch (e) {
					return false;
				}
			}
		  </script><p class=small><a href="#Udskriv dokument" onclick="return printDocTest()">Udskriv dokument</a></p><p class=small>
	<br><a href="#Sl highlights til/fra" onclick="curClass=document.body.className;document.body.className=curClass.replace(/HideTags/gi,'')+(curClass.indexOf('HideTags')>-1?'':' HideTags');return false;">Sl highlights til/fra</a>
	<br/><br/><b>Sti til dokumentet:</b><br>https://ekstern.infonet.regionsyddanmark.dk/files/dokument837589.htm </p></td></tr></table></div></div></div>
				<div class="dsidExCoBox" id="dsidExCoBox837589" onclick="DocHeadShowHide(this,837589)"></div>
				<div class="dsidDocWrap">
				<div class="dsidDocHeadBaseWrapWrap " id="dsidDocHeadBaseWrapWrap837589">
				<div class="dsidDocHeadWrapWrap  dsidDocHeadWrapWrapClosed" id="docHeadWrapWrap837589">
				<div class="dsidPageOverTopLeft" id="dsidPageOverTopLeft837589"></div>
				<div class="dsidPageOverTopRight" id="dsidPageOverTopRight837589"></div>
				<div class="dsidPageOverTopCent" id="dsidPageOverTopCent837589"></div>
				<div class="dsidDocHeadWrap" id="docHeadWrap837589" style="position:relative;">
				<div class="dsidDocHead" id="docHead837589"><table width=100% cellspacing=0 cellpadding=0 border=0 style="border-collapse:collapse;">
<tr class="dsidDocHeadTR">
<td class="dsidDocHeadTD" colspan="1"><div style="height:40px;width:1px;float:right"></div><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel"><nobr>Dokumentbrugere:</nobr><br></span><b><span class="docHeadInfo"><span uid="792,null,null,null,null" onmouseover="showPopUp('<b>Eksterne samarbejdspartnere (SygH, Eksterne)</b><br />',event,this,true)" onmouseout="hidePopUp()">Eksterne</span>, <span uid="199,null,null,null,null" onmouseover="showPopUp('<b>Esbjerg Grindsted Sygehus (SygH, SVS)</b><br />',event,this,true)" onmouseout="hidePopUp()">SVS</span></span></b></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class=docHeadLabel>Dokument ID:<br></span><span class="docHeadInfo"><b>837589</b></span></div></td>

<td class="dsidDocHeadTD" colspan="2" nowrap><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel">Forfatter:<br></span><b><span class="docHeadInfo">Marc Trunjer Kusk Nielsen</span></b></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel">Udgivelsesdato:<br></span><span class="docHeadInfo"><b>21.05.2024</b></span></div></td>


</tr>
<tr class="dsidDocHeadTR">
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel"><nobr>Lseadgang:</nobr><br></span><b><span class="docHeadInfo"><span uid="1958,null,null,null,null" onmouseover="showPopUp('<b>Internettet (InfoNet Eksternt Site) (Ansv, Internet)</b><br />',event,this,true)" onmouseout="hidePopUp()">Internet</span></span></b></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItemNiv"><span class="docHeadLabel">Niveau:<br></span><span class="docHeadInfo"><b>Instruks</b></span></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel">Dokumentansvarlig:<br></span><b uid="199,388,548,null,null" uname="Esbjerg Grindsted Sygehus/Mikrobiologi/SVS-KDA - Ledende ovelge*" onmouseover="showPopUp('<b>Esbjerg Grindsted Sygehus/Mikrobiologi/SVS-KDA - Ledende ovel\u00e6ge*</b><br />',event,this,true,1)" onmouseout="hidePopUp()"><span class="docHeadInfo">SVS/Mikrobiolo/Spec.OLge</span></b></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel">Version:<br></span><b><span class="docHeadInfo">2.3</span></b></div></td>
<td class="dsidDocHeadTD"><div class="dsidInfoItem dsidInfoItem"><span class="docHeadLabel">Godkendt af:<br></span><div><span class="docHeadInfo"><b title="Ditte Nrgaard Jrgensen, Klinisk diagnostik"><span class=docHeadInfo>Ditte Nrgaard Jrgensen</span></b></span></div></div></td>
</tr>

</table></div></div></div>
			
			<div class="dsidDocBaseWrap" id="dsidDocBaseWrap837589">
			<div class="dsidPageOverLeft"></div><div class="dsidPageOverRight"></div>
			<div class="dsidPageOverBotCent"></div>
            <div class="dsidDocOverWrap"><div class="dsidDocContWrap">
			<div style="padding:0px;margin:0px;height:1px;"></div><div class="hideScreen dsidDocNamePrefix"><span class="docHeadLabel">Udskrevet er dokumentet ikke versionsstyret.</span></div>
			<div class="dsidDocNameLogo"><table cellpadding=0 cellspacing=0 border=0 width="100%" class="tblDokNameLogo">
			<tr><td valign=top class="dsidDocNameCell"><h1>Bakterielt luftvejspanel DNA</h1></td><td width=150 class="dsidDocLogoCell"><img class="dsidPageLogo" src="res/logo_11.png" alt=""></td></tr></table></div><table cellspacing="0" cellpadding="0" border="0" width="100%" id="tbSysDokInfo" class="tbSysDokInfo"><tr><td valign="top" width="44">&nbsp;</td><td width=""><span class="hidePrint"></span>&nbsp;</td></tr></table><table cellspacing="0" cellpadding="0" border="0" width="100%" id="tbSysDokFormaal" class="tbSysDokFormaal"><tr><td style="width:44px"></td><td valign="top"></td></tr><tr><td valign="top" style="width:44px">&nbsp;</td><td width="" style=""><span class="spD4DocBody"><p><strong></strong>&nbsp;</p>
<p>
<table width="100%" class="MsoNormalTable" style="width: 100%; border-collapse: collapse;" border="0" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td width="50%" valign="top" style="padding: 0cm; width: 50%;">
<p class="MsoNormal"><strong>KLINISK MIKROBIOLOGISK AFSNIT</strong></p></td>
<td width="50%" style="padding: 0cm; width: 50%;">
<p align="right" style="text-align: right;"><span style="font-family: Verdana;"><strong>LABORATORIEINFORMATION</strong></span></p></td></tr></tbody></table><p></p></span></td></tr></table><table cellspacing="0" cellpadding="0" border="0" width="100%" id="tbSysAfsnitStart" class="tbSysAfsnitStart"><tbody><tr><td valign="top" width="44">&nbsp;</td><td width="">&nbsp;</td></tr><tr><td></td><td valign="top"></td></tr></tbody></table><table id="tableDokAfsnit5085680" class="tableDokAfsnit" dokafsnitid="5085680" cellspacing="0" cellpadding="0" border="0" width="100%"><colgroup><col width="44"><col width="*"></colgroup><tbody><tr><td valign="top" width="44" align="right" style=""><a name="dafs5085680"></a><a name="afs3947950"></a><a name="nr"></a><a name="Nr"></a><a name="NR"></a><a name="rub1"></a><a name="Rub1"></a><span class="rubBesNr">&nbsp;</span><br></td><td valign="top" style="" class=""><span class="spD4DocBody spD4DocBodydafs5085680 spD4DocBodyafs3947950"><p>&nbsp;</p>
<p><a name="UNDERSGELSENSPRINCIP1"></a><a href="#UNDERSGELSENSPRINCIP" target="_self"><strong><b>UNDERSGELSENS </b></strong><b>PRINCIP</b></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="INDIKATION1"></a><a href="#INDIKATION" target="_self"><strong><b>INDIKATION</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="PRVEMATERIALE1"></a><a href="#PRVEMATERIALE" target="_self"><strong><b>PRVEMATERIALE</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp;&nbsp;</b></strong><strong><b>&nbsp; </b></strong><a name="UTENSILIER1"></a><a href="#UTENSILIER" target="_self"><strong><b>UTENSILIER</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="PRVETAGNING1"></a><a href="#PRVETAGNING" target="_self"><strong><b>PRVETAGNING</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="OPBEVARING1"></a><a href="#OPBEVARING" target="_self"><strong><b>OPBEVARING</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="FORSENDELSE1"></a><a href="#FORSENDELSE" target="_self"><strong><b>FORSENDELSE</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="SVARAFGIVELSE1"></a><a href="#SVARAFGIVELSE" target="_self"><strong><b>SVARAFGIVELSE</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="TOLKNING1"></a><a href="#TOLKNING" target="_self"><strong><b>TOLKNING</b></strong></a><strong><b>&nbsp; </b></strong><strong><b></b></strong><strong><b>&nbsp; </b></strong><a name="SRLIGEBEMRKNINGER1"></a><a href="#SRLIGEBEMRKNINGER" target="_self"><strong><b>SRLIGE BEMRKNINGER</b></strong></a></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<table width="100%" border="1" cellspacing="0" cellpadding="2">
<tbody>
<tr><td width="27%" valign="top"><p>IUPAC: -</p><p><img width="175" height="62" title="DANAK mrke.png" alt="" src="formularer\Upload\2022\10\DANAK mrke_1.png" border="0" oriwidth="249" oriheight="88" realwidth="249" realheight="88"><br></p></td><td width="73%" valign="middle">&nbsp;<strong>Bakterielt luftvejspanel DNA</strong></td></tr><tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="UNDERSGELSENSPRINCIP"><strong><b>UNDERSGELSENS PRINCIP</b></strong></a></p></td>
<td width="73%" valign="top">
<p>Pvisning&nbsp;af specifikke gensekvenser fra <i>Bordetella parapertusis</i> (BPP), <i>Bordetella pertusis</i> (BP), <i>Chlamydophila pneumoniae</i> (CP), <i>Mycoplasma pneumoniae</i> (MP), <i>Legionella pneumophila</i> (LP), <i>Streptococcus pneumoniae</i> (SP) og <i>Haemophilus influenzae</i> (HI) ved hjlp af multiplex Real-Time PCR (Allplex).</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="INDIKATION"><strong><b>INDIKATION</b></strong></a></p></td>
<td width="73%" valign="top">
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>Mistanke om pneumoni forrsaget af bakterier.</p><p>&nbsp;</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="PRVEMATERIALE"><strong><b>PRVEMATERIALE</b></strong></a></p></td>
<td width="73%" valign="top"><!--?xml:namespace prefix = "o" ns = "urn:schemas-microsoft-com:office:office" /-->
<p></p>
<p></p><p>Nasotrakealsekret, nasopharyngeal podeprve, oropharyngeal podeprve, bronchoalveolar lavage (BAL), ekspektorat og trachealsekret.</p><p><br></p><p>Fra praksis analyseres kun prver fra nedre luftveje.</p><p>Podeprver undersges kun sfremt der er gjort relevant forsg p udtagning af materiale fra nedre luftveje frst.</p></td></tr>

<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="UTENSILIER"><strong><b>UTENSILIER</b></strong></a></p></td>
<td width="73%" valign="top">
<p>COPAN E-Swab eller UTM. Rr (sterilt tr glas)&nbsp;fra trakealsugest eller ekspektoratdobbeltdse.&nbsp;&nbsp;</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="PRVETAGNING"><strong><b>PRVETAGNING</b></strong></a></p></td>
<td width="73%" valign="top">
<p></p>
<p></p><p>S tidligt som muligt i sygdomsforlbet.</p><p>&nbsp;</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="OPBEVARING"><strong><b>OPBEVARING</b></strong></a></p></td>
<td width="73%" valign="top">
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>
<p>Prvematerialet opbevares ved 2-8C i op til 3 dage (fra prvetagningstidspunkt til analyse).&nbsp;</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="FORSENDELSE"><strong><b>FORSENDELSE</b></strong></a></p></td>
<td width="73%" valign="top">
<p>Prven bestilles i BCC Mikrobiologi, analyse nummer 220. Bringes straks til laboratoriet.&nbsp;</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="SVARAFGIVELSE"><strong><b>SVARAFGIVELSE</b></strong></a></p></td>
<td width="73%" valign="top">
<p></p>
<p>Svar afgives som henholdsvis "detected/positiv", "not detected/negativ", "invalid", (som svares Prvematerialet indeholder stoffer, som hmmer PCR-undersgelsen. Ny prve udbedes") eller analysefejl (som svares Analysen er desvrre mislykket. Vi krer prven om igen, s send ikke en ny prve. Nyt svar flger  ring venligst ikke til KMA).&nbsp;</p><p>Der kan forventes svar indenfor 2 hverdage.</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00">
<p><a name="TOLKNING"><strong><b>TOLKNING</b></strong></a></p></td>
<td width="73%" valign="top">
<p></p>
<p></p>
<p>Et positiv PCR-svar&nbsp;er forenelig med aktuel eller nylig infektion. PCR metoden pviser levende svel som dde bakterier og kan derfor ikke anvendes til behandlingskontrol. Et negativt resultat udelukker ikke infektion med de undersgte bakterier.</p></td></tr>
<tr>
<td width="27%" valign="top" style="background-color: rgb(153, 204, 0);" bgcolor="#99cc00"><strong><a name="SRLIGEBEMRKNINGER"><strong>SRLIGE BEMRKNINGER</strong></a></strong>&nbsp;</td>
<td width="73%" valign="top">
<p>Ved mistanke om infektion med Legionella pneumophila skal der sendes materiale fra nedre luftveje (BAL, trakealsekret eller ekspektorat).</p></td></tr></tbody></table>
<p>&nbsp;</p></span><span class="spD4DocBodyEnd"><br>&nbsp;</span></td></tr></tbody></table><table id="tableDokAfsnit5085681" class="tableDokAfsnit" dokafsnitid="5085681" cellspacing="0" cellpadding="0" border="0" width="100%"><colgroup><col width="44"><col width="*"></colgroup><tbody><tr><td valign="top" width="44" align="right" style=""><a name="dafs5085681"></a><a name="afs3947951"></a><a name="nr"></a><a name="Nr"></a><a name="NR"></a><a name="rub2"></a><a name="Rub2"></a><span class="rubBesNr">&nbsp;</span><br></td><td valign="top" style="" class=""><span class="spD4DocBody spD4DocBodydafs5085681 spD4DocBodyafs3947951"><p>
<table width="100%" id="tableDokAfsnit1734764" border="0" cellspacing="2" cellpadding="0" dokafsnitid="1734764">
<tbody>
<tr>
<td width="20" valign="top"><br></td>
<td valign="top">
<p><b>DOKUMENTLOGISTIK</b></p>
<table width="93%" style="border-collapse: collapse;" border="1" cellspacing="0" cellpadding="2">
<tbody>
<tr>
<td width="27%" style="background-color: rgb(230, 230, 230);" colspan="2">
<p>ISO 15189:2013</p></td>
<td width="72%" style="background-color: transparent;">
<p><!--?xml:namespace prefix = "o" ns = "urn:schemas-microsoft-com:office:office" /-->4.7 Rdgivningsydelser&nbsp;</p></td></tr>

<tr>
<td width="27%" style="background-color: rgb(230, 230, 230);" colspan="2">
<p>Udarbejdet af</p></td>
<td width="72%" style="background-color: transparent;">
<p>RADA, MTN</p></td></tr>
<tr>
<td width="27%" style="background-color: rgb(230, 230, 230);" colspan="2">
<p>Arkiveringssted og tid</p></td>
<td width="72%" style="background-color: transparent;">
<p>Infonet, minimum 5 r efter versionen er udget</p></td></tr>
<tr>
<td width="27%" style="background-color: rgb(230, 230, 230);" colspan="2">
<p>Distribution</p></td>
<td width="72%" style="background-color: transparent;">
<p>Infonet, Eksternt infonet</p></td></tr>
<tr>
<td width="13%" style="background-color: rgb(230, 230, 230);">
<p>Dato</p></td>
<td width="13%" style="background-color: rgb(230, 230, 230);">
<p>Version</p></td>
<td width="72%" style="background-color: rgb(230, 230, 230);">
<p>ndringsmeddelelser</p></td></tr>
<tr><td width="13%" valign="top" style="background-color: transparent;">-</td><td width="13%" valign="top" style="background-color: transparent;">2.3&nbsp;</td><td width="72%" valign="top" style="background-color: transparent;">Podeprver undersges kun efter relevant forsg p prvetagning fra nedre luftveje.</td></tr><tr><td width="13%" valign="top" style="background-color: transparent;">22.11.2023</td><td width="13%" valign="top" style="background-color: transparent;">2.2&nbsp;</td><td width="72%" valign="top" style="background-color: transparent;">Forventet svartid er tilfjet&nbsp;</td></tr><tr><td width="13%" valign="top" style="background-color: transparent;">18.09.2023</td><td width="13%" valign="top" style="background-color: transparent;">2.1</td><td width="72%" valign="top" style="background-color: transparent;">For praksis analyseres kun prver fra nedre luftveje. Som udmeldt i Nyhedsbrev 2023-03-27.</td></tr><tr><td width="13%" valign="top" style="background-color: transparent;">27.11.2022&nbsp;</td><td width="13%" valign="top" style="background-color: transparent;">2&nbsp;</td><td width="72%" valign="top" style="background-color: transparent;">DANAK akkrediteringsmrke tilfjet&nbsp;</td></tr><tr>
<td width="13%" valign="top" style="background-color: transparent;"><em>23.03.2021</em></td>
<td width="13%" valign="top" style="background-color: transparent;">
<p><em>1</em></p></td>
<td width="72%" valign="top" style="background-color: transparent;">
<p><em>Nyt dokument</em></p></td></tr>
</tbody></table></td></tr></tbody></table><p></p></span></td></tr></tbody></table><div class="DocBodyDocReferences"><table id="tblBodyDocReferences" cellspacing=0 cellpadding=0 border=0 width="100%"><tr><td width="33%" valign=top id="tdBodyDocLinks3"></td></tr></table>
			<script type="text/javascript">
				var tdLinks1=document.getElementById("tdBodyDocLinks1");
				var tdLinks2=document.getElementById("tdBodyDocLinks2");
				var tdLinks3=document.getElementById("tdBodyDocLinks3");
				var tdCount=(tdLinks1 && tdLinks1.firstElementChild?1:0)+(tdLinks2 && tdLinks2.firstElementChild?1:0)+(tdLinks3 && tdLinks3.firstElementChild?1:0);
				if (tdCount<3) {
					tdCount=2;	// ellers kan man mske blive forvirret over at fx formularer nu str helt til venstre...
					if (tdLinks1) tdLinks1.setAttribute("width",(tdLinks1.firstElementChild?(100/tdCount):0)+"%");
					if (tdLinks2) tdLinks2.setAttribute("width",(tdLinks2.firstElementChild?(100/tdCount):0)+"%");
					if (tdLinks3) tdLinks3.setAttribute("width",(tdLinks3.firstElementChild?(100/tdCount):0)+"%");
				}
			</script></div></div></div></div></div></div></div></div></div>
</body>

</html>
